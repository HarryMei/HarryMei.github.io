<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
    <title>Harry Mei&#39;Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta property="og:type" content="website">
<meta property="og:title" content="Harry Mei&#39;Blog">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Harry Mei&#39;Blog">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Harry Mei&#39;Blog">
    

    
        <link rel="alternate" href="/" title="Harry Mei&#39;Blog" type="application/atom+xml" />
    

    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/open-sans/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.1.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
    
    


</head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
                <span class="site-title">Harry Mei&#39;Blog</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/.">Home</a>
                
                    <a class="main-nav-link" href="/archives">Archives</a>
                
                    <a class="main-nav-link" href="/categories">Categories</a>
                
                    <a class="main-nav-link" href="/tags">Tags</a>
                
                    <a class="main-nav-link" href="/about">About</a>
                
            </nav>
            
                
                <nav id="sub-nav">
                    <div class="profile" id="profile-nav">
                        <a id="profile-anchor" href="javascript:;">
                            <img class="avatar" src="/css/images/cast.jpg" />
                            <i class="fa fa-caret-down"></i>
                        </a>
                    </div>
                </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/.">Home</a></td>
                
                    <td><a class="main-nav-link" href="/archives">Archives</a></td>
                
                    <td><a class="main-nav-link" href="/categories">Categories</a></td>
                
                    <td><a class="main-nav-link" href="/tags">Tags</a></td>
                
                    <td><a class="main-nav-link" href="/about">About</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
                

<aside id="profile" class="profile-fixed">
    <div class="inner profile-inner">
        <div class="base-info profile-block">
            <img id="avatar" src="/css/images/cast.jpg" />
            <h2 id="name">Harry Mei</h2>
            <h3 id="title">coder</h3>
            <span id="location"><i class="fa fa-map-marker"></i>Shenzhen, China</span>
            <a id="follow" target="_blank" href="https://github.com/HarryMei/">FOLLOW</a>
        </div>
        <div class="article-info profile-block">
            <div class="article-info-block">
                84
                <span>posts</span>
            </div>
            <div class="article-info-block">
                121
                <span>tags</span>
            </div>
        </div>
        
        <div class="profile-block social-links">
            <table>
                <tr>
                    
                    
                    <td>
                        <a href="http://github.com/HarryMei/" target="_blank" title="github" class=tooltip>
                            <i class="fa fa-github"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="http://weibo.com/1503717973/" target="_blank" title="twitter" class=tooltip>
                            <i class="fa fa-twitter"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="facebook" class=tooltip>
                            <i class="fa fa-facebook"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="dribbble" class=tooltip>
                            <i class="fa fa-dribbble"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="rss" class=tooltip>
                            <i class="fa fa-rss"></i>
                        </a>
                    </td>
                    
                </tr>
            </table>
        </div>
        
    </div>
</aside>

            
            <section id="main">
    <article id="post-现代OpenGL的基本使用" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2018/10/20/现代OpenGL的基本使用/">现代OpenGL的基本使用</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2018/10/20/现代OpenGL的基本使用/">
            <time datetime="2018-10-20T14:12:19.000Z" itemprop="datePublished">2018-10-20</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/技术/">技术</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/技术/OpenGL/">OpenGL</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Assimp/">Assimp</a>, <a class="tag-link" href="/tags/C/">C++</a>, <a class="tag-link" href="/tags/GLAD/">GLAD</a>, <a class="tag-link" href="/tags/GLFW/">GLFW</a>, <a class="tag-link" href="/tags/OpenGL/">OpenGL</a>, <a class="tag-link" href="/tags/Shader/">Shader</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>OpenGL不过作为一个标准不断更新与改进的底层图形库，其新旧版本的使用区别很大，前面我们使用python接口对OpenGL进行简单的使用用的是其老式的方法，现在我们要使用新的特性，因此本文在实际代码实现中结合新版OpenGL的特性进行说明。另外为避免因版本不同而导致的问题，使用其原生的C++的接口通常是一个更好的选择。</p>
<p>在这里我使用环境如下：</p>
<ul>
<li>系统：Windows 10</li>
<li>编译器：VS 2015</li>
</ul>
<h2 id="会使用到的概念"><a href="#会使用到的概念" class="headerlink" title="会使用到的概念"></a>会使用到的概念</h2><h4 id="1-标准化设备坐标-Normalized-Device-Coordinates-NDC"><a href="#1-标准化设备坐标-Normalized-Device-Coordinates-NDC" class="headerlink" title="1. 标准化设备坐标(Normalized Device Coordinates, NDC)"></a>1. 标准化设备坐标(Normalized Device Coordinates, NDC)</h4><p>标准化设备坐标是一个x、y和z值在-1.0到1.0的一小段空间。任何落在范围外的坐标都会被丢弃/裁剪，不会显示在你的屏幕上。与通常的屏幕坐标不同，y轴正方向为向上，(0, 0)坐标是这个图像的中心，而不是左上角。最终你希望所有(变换过的)坐标都在这个坐标空间中，否则它们就不可见了。</p>
<p>OpenGL仅当3D坐标在3个轴（x、y和z）上都为-1.0到1.0的范围内时才处理它。所有在所谓的标准化设备坐标(Normalized Device Coordinates)范围内的坐标才会最终呈现在屏幕上，一旦你的顶点坐标已经在顶点着色器中处理过，它们就应该是标准化设备坐标了。</p>
<h4 id="2-顶点缓冲对象-Vertex-Buffer-Objects-VBO"><a href="#2-顶点缓冲对象-Vertex-Buffer-Objects-VBO" class="headerlink" title="2. 顶点缓冲对象(Vertex Buffer Objects, VBO)"></a>2. 顶点缓冲对象(Vertex Buffer Objects, VBO)</h4><p>我们通过顶点缓冲对象(Vertex Buffer Objects, VBO)管理这个内存，它会在GPU内存（通常被称为显存）中储存大量顶点。使用这些缓冲对象的好处是我们可以一次性的发送一大批数据到显卡上，而不是每个顶点发送一次。</p>
<p>顶点缓冲对象是我们在接触现代OpenGL各种对象中最基本的一类。它与其他OpenGL中的对象一样，有一个独一无二的ID，通过glGenBuffers函数生成；同时使用glBindBuffer函数设置缓冲类型；我们可以调用glBufferData函数，它会把之前定义的顶点数据复制到缓冲的内存中。</p>
<h4 id="3-着色器"><a href="#3-着色器" class="headerlink" title="3. 着色器"></a>3. 着色器</h4><p>如果我们打算做渲染的话，现代OpenGL需要我们至少设置一个顶点和一个片段着色器。我们需要做的第一件事是用着色器语言GLSL(OpenGL Shading Language)编写顶点着色器，然后编译这个着色器，这样我们就可以在程序中使用它了。</p>
<p>顶点着色器代码如下，功能只是坐标转化，将输入的坐标转化为OpenGL内部能够处理的形式，相当于最简单的着色器了：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#version 330 core</span></span><br><span class="line">layout (location = <span class="number">0</span>) in vec3 aPos;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    gl_Position = vec4(aPos.x, aPos.y, aPos.z, <span class="number">1.0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>片段着色器代码如下，功能同样是最简单的了，即设置固定的颜色：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#version 330 core</span></span><br><span class="line">out vec4 FragColor;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    FragColor = vec4(<span class="number">1.0f</span>, <span class="number">0.5f</span>, <span class="number">0.2f</span>, <span class="number">1.0f</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="4-编译和链接着色器"><a href="#4-编译和链接着色器" class="headerlink" title="4. 编译和链接着色器"></a>4. 编译和链接着色器</h4><p>上面的着色器代码，我们必须在运行时动态编译它的源码，才能够让OpenGL使用。首先要做的是创建一个着色器对象，注意还是用ID来引用的。首先用glCreateShader创建这个着色器，然后我们把这个着色器源码附加到着色器对象上，然后再编译它。</p>
<p>着色器程序对象(Shader Program Object)是多个着色器合并之后并最终链接完成的版本。如果要使用刚才编译的着色器我们必须把它们链接(Link)为一个着色器程序对象，然后在渲染对象的时候激活这个着色器程序。已激活着色器程序的着色器将在我们发送渲染调用的时候被使用。当链接着色器至一个程序的时候，它会把每个着色器的输出链接到下个着色器的输入。当输出和输入不匹配的时候，你会得到一个连接错误。</p>
<h2 id="编译两个第三方库"><a href="#编译两个第三方库" class="headerlink" title="编译两个第三方库"></a>编译两个第三方库</h2><ul>
<li>GLAD 负责绘图函数的获取</li>
<li>GLFW 负责创建绘图上下文和窗口系统管理</li>
</ul>
<h4 id="1-GLFW库"><a href="#1-GLFW库" class="headerlink" title="1. GLFW库"></a>1. GLFW库</h4><p>GLFW是一个专门针对OpenGL的C语言库，它提供了一些渲染物体所需的最低限度的接口，所以它非常的小。它允许用户创建OpenGL上下文，定义窗口参数以及处理用户输入。</p>
<p>为了使用GLFW，同时避免一些兼容性的问题，我们最好自己下载源码编译，GLFW的下载地址为：<a href="http://www.glfw.org/download.html" target="_blank" rel="noopener">http://www.glfw.org/download.html</a>，其编译过程在参考链接1中有详细的讲解。编译成成功后会在src/Debug或者src/Release中生成库文件：glfw3.lib</p>
<h4 id="2-配置GLAD"><a href="#2-配置GLAD" class="headerlink" title="2. 配置GLAD"></a>2. 配置GLAD</h4><p>GLAD是一个开源的库，作用是为了简化OpenGL中的函数调用。在参考链接2中使用的是GLEW库，其作用是一样的。</p>
<p>GLAD使用了一个在线服务，地址为：<a href="https://glad.dav1d.de/" target="_blank" rel="noopener">https://glad.dav1d.de/</a>,选择相应的配置选项，网站就能自动生成库文件。在这里我们只要选择语言为：c/c++、Profile：core、版本选择3.3或者以上就可以了。</p>
<p>GLAD现在应该提供给你了一个zip压缩文件，下载zip文件，包含两个头文件目录，和一个glad.c文件。将两个头文件目录（glad和KHR）复制到你的Include文件夹中（或者增加一个额外的项目指向这些目录），并添加glad.c文件到你的工程中。</p>
<h2 id="新建VS工程"><a href="#新建VS工程" class="headerlink" title="新建VS工程"></a>新建VS工程</h2><p>新建vs空项目，将OpenGL、GLFW、GLAD的目录与库文件添加项目属性中，具体说明见参考链接1。对于Windows平台，opengl32.lib已经包含在Microsoft SDK里了，它在Visual Studio安装的时候就默认安装了，但是需要将GLFW、GLAD库加入。</p>
<h2 id="基本窗口代码"><a href="#基本窗口代码" class="headerlink" title="基本窗口代码"></a>基本窗口代码</h2><p>下面代码，主要用创建窗口, setVertixData()、deleteObj()、compileShader()、render()函数暂时为空。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;glad/glad.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;GLFW/glfw3.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">framebuffer_size_callback</span><span class="params">(GLFWwindow* window, <span class="keyword">int</span> width, <span class="keyword">int</span> height)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">processInput</span><span class="params">(GLFWwindow *window)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setVertixData</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;VBO, <span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;VAO)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">deleteObj</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;VBO, <span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;VAO)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">compileShader</span><span class="params">(<span class="keyword">int</span>&amp; shaderProgram)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">render</span><span class="params">(<span class="keyword">int</span>&amp; shaderProgram, <span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;VAO)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    glfwInit();</span><br><span class="line">    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, <span class="number">3</span>);</span><br><span class="line">    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, <span class="number">3</span>);</span><br><span class="line">    glfwWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);</span><br><span class="line"></span><br><span class="line">    GLFWwindow* window = glfwCreateWindow(<span class="number">800</span>, <span class="number">600</span>, <span class="string">"LearnOpenGL"</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">if</span> (window == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Failed to create GLFW window"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">            glfwTerminate();</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    glfwMakeContextCurrent(window);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// GLAD init</span></span><br><span class="line">    <span class="keyword">if</span> (!gladLoadGLLoader((GLADloadproc)glfwGetProcAddress))</span><br><span class="line">    &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Failed to initialize GLAD"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 编译shader</span></span><br><span class="line">    <span class="keyword">int</span> shaderProgram;</span><br><span class="line">    compileShader(shaderProgram);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置定点对象</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> VBO, VAO;</span><br><span class="line">    setVertixData(VBO, VAO);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置视窗大小</span></span><br><span class="line">    glViewport(<span class="number">0</span>, <span class="number">0</span>, <span class="number">800</span>, <span class="number">600</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 窗口大小改变时的回调：随窗口改变调整绘制</span></span><br><span class="line">    glfwSetFramebufferSizeCallback(window, framebuffer_size_callback);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 在窗口关闭前一直绘制</span></span><br><span class="line">    <span class="keyword">while</span> (!glfwWindowShouldClose(window))</span><br><span class="line">    &#123;</span><br><span class="line">            <span class="comment">// 接受窗口输入</span></span><br><span class="line">            processInput(window);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 渲染指令</span></span><br><span class="line">            render(shaderProgram, VAO);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 检查并调用事件，交换缓冲</span></span><br><span class="line">            glfwSwapBuffers(window);</span><br><span class="line">            glfwPollEvents();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 删除创建的对象</span></span><br><span class="line">    deleteObj(VBO, VAO);</span><br><span class="line"></span><br><span class="line">    glfwTerminate();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="基本绘制代码"><a href="#基本绘制代码" class="headerlink" title="基本绘制代码"></a>基本绘制代码</h2><p>以下实现setVertixData()、deleteObj()、compileShader()、render()四个函数，功能是绘制一个三角形，shader代码也直接集成到c++源码中，用字符串数组记录：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *vertexShaderSource = <span class="string">"#version 330 core\n"</span></span><br><span class="line"><span class="string">"layout (location = 0) in vec3 aPos;\n"</span></span><br><span class="line"><span class="string">"void main()\n"</span></span><br><span class="line"><span class="string">"&#123;\n"</span></span><br><span class="line"><span class="string">"   gl_Position = vec4(aPos.x, aPos.y, aPos.z, 1.0);\n"</span></span><br><span class="line"><span class="string">"&#125;\0"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *fragmentShaderSource = <span class="string">"#version 330 core\n"</span></span><br><span class="line"><span class="string">"out vec4 FragColor;\n"</span></span><br><span class="line"><span class="string">"void main()\n"</span></span><br><span class="line"><span class="string">"&#123;\n"</span></span><br><span class="line"><span class="string">"   FragColor = vec4(1.0f, 0.5f, 0.2f, 1.0f);\n"</span></span><br><span class="line"><span class="string">"&#125;\n\0"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setVertixData</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;VBO, <span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;VAO)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">float</span> vertices[] = &#123;</span><br><span class="line">        <span class="number">-0.5f</span>, <span class="number">-0.5f</span>, <span class="number">0.0f</span>,</span><br><span class="line">        <span class="number">0.5f</span>, <span class="number">-0.5f</span>, <span class="number">0.0f</span>,</span><br><span class="line">        <span class="number">0.0f</span>,  <span class="number">0.5f</span>, <span class="number">0.0f</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    glGenBuffers(<span class="number">1</span>, &amp;VBO);</span><br><span class="line">    glGenVertexArrays(<span class="number">1</span>, &amp;VAO);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// bind the Vertex Array Object first, then bind and set vertex buffer(s), and then configure vertex attributes(s).</span></span><br><span class="line">    glBindVertexArray(VAO);</span><br><span class="line"></span><br><span class="line">    glBindBuffer(GL_ARRAY_BUFFER, VBO);</span><br><span class="line">    glBufferData(GL_ARRAY_BUFFER, <span class="keyword">sizeof</span>(vertices), vertices,</span><br><span class="line">GL_STATIC_DRAW);</span><br><span class="line"></span><br><span class="line">    glVertexAttribPointer(<span class="number">0</span>, <span class="number">3</span>, GL_FLOAT, GL_FALSE, <span class="number">3</span> * <span class="keyword">sizeof</span>(<span class="keyword">float</span>),</span><br><span class="line">(<span class="keyword">void</span>*)<span class="number">0</span>);</span><br><span class="line">    glEnableVertexAttribArray(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// note that this is allowed, the call to glVertexAttribPointer registered VBO as the vertex attribute's bound vertex buffer object so afterwards we can safely unbind</span></span><br><span class="line">    glBindBuffer(GL_ARRAY_BUFFER, <span class="number">0</span>);</span><br><span class="line">    glBindVertexArray(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">deleteObj</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;VBO, <span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;VAO)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    glDeleteVertexArrays(<span class="number">1</span>, &amp;VAO);</span><br><span class="line">    glDeleteBuffers(<span class="number">1</span>, &amp;VBO);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">compileShader</span><span class="params">(<span class="keyword">int</span>&amp; shaderProgram)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// vertex shader</span></span><br><span class="line">    <span class="keyword">int</span> vertexShader = glCreateShader(GL_VERTEX_SHADER);</span><br><span class="line">    glShaderSource(vertexShader, <span class="number">1</span>, &amp;vertexShaderSource, <span class="literal">NULL</span>);</span><br><span class="line">    glCompileShader(vertexShader);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// check for shader compile errors</span></span><br><span class="line">    <span class="keyword">int</span> success;</span><br><span class="line">    <span class="keyword">char</span> infoLog[<span class="number">512</span>];</span><br><span class="line">    glGetShaderiv(vertexShader, GL_COMPILE_STATUS, &amp;success);</span><br><span class="line">    <span class="keyword">if</span> (!success)</span><br><span class="line">    &#123;</span><br><span class="line">        glGetShaderInfoLog(vertexShader, <span class="number">512</span>, <span class="literal">NULL</span>, infoLog);</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"ERROR::SHADER::VERTEX::COMPILATION_FAILED\n"</span> &lt;&lt; infoLog &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// fragment shader</span></span><br><span class="line">    <span class="keyword">int</span> fragmentShader = glCreateShader(GL_FRAGMENT_SHADER);</span><br><span class="line">    glShaderSource(fragmentShader, <span class="number">1</span>, &amp;fragmentShaderSource, <span class="literal">NULL</span>);</span><br><span class="line">    glCompileShader(fragmentShader);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// check for shader compile errors</span></span><br><span class="line">    glGetShaderiv(fragmentShader, GL_COMPILE_STATUS, &amp;success);</span><br><span class="line">    <span class="keyword">if</span> (!success)</span><br><span class="line">    &#123;</span><br><span class="line">        glGetShaderInfoLog(fragmentShader, <span class="number">512</span>, <span class="literal">NULL</span>, infoLog);</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"ERROR::SHADER::FRAGMENT::COMPILATION_FAILED\n"</span> &lt;&lt; infoLog &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// link shaders</span></span><br><span class="line">    shaderProgram = glCreateProgram();</span><br><span class="line">    glAttachShader(shaderProgram, vertexShader);</span><br><span class="line">    glAttachShader(shaderProgram, fragmentShader);</span><br><span class="line">    glLinkProgram(shaderProgram);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// check for linking errors</span></span><br><span class="line">    glGetProgramiv(shaderProgram, GL_LINK_STATUS, &amp;success);</span><br><span class="line">    <span class="keyword">if</span> (!success) &#123;</span><br><span class="line">        glGetProgramInfoLog(shaderProgram, <span class="number">512</span>, <span class="literal">NULL</span>, infoLog);</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"ERROR::SHADER::PROGRAM::LINKING_FAILED\n"</span> &lt;&lt; infoLog &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    glDeleteShader(vertexShader);</span><br><span class="line">    glDeleteShader(fragmentShader);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">render</span><span class="params">(<span class="keyword">int</span> &amp;shaderProgram, <span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;VAO)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// render</span></span><br><span class="line">    <span class="comment">// ------</span></span><br><span class="line">    glClearColor(<span class="number">0.2f</span>, <span class="number">0.3f</span>, <span class="number">0.3f</span>, <span class="number">1.0f</span>);</span><br><span class="line">    glClear(GL_COLOR_BUFFER_BIT);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// draw our first triangle</span></span><br><span class="line">    glUseProgram(shaderProgram);</span><br><span class="line">    <span class="comment">// seeing as we only have a single VAO there's no need to bind it every time, but we'll do so to keep things a bit more organized</span></span><br><span class="line">    glBindVertexArray(VAO);</span><br><span class="line">    glDrawArrays(GL_TRIANGLES, <span class="number">0</span>, <span class="number">3</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="使用索引缓冲对象改进绘制"><a href="#使用索引缓冲对象改进绘制" class="headerlink" title="使用索引缓冲对象改进绘制"></a>使用索引缓冲对象改进绘制</h2><p>绘制复杂的图像，一般需要使用索引缓冲对象(Element Buffer Object，EBO，也叫Index Buffer Object，IBO)。OpenGL调用这些顶点的索引来决定该绘制哪个顶点，如矩形由两个三角形组成，绘制时只要指定四个端点、设置两个三角形分别指定的端点。</p>
<p>对setVertixData()、deleteObj()、render()三个函数做部分修改：</p>
<ul>
<li>修改函数申明：</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setVertixData</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;VBO, <span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;VAO, <span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;EBO)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">deleteObj</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;VBO, <span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;VAO, <span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;EBO)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">render</span><span class="params">(<span class="keyword">int</span>&amp; shaderProgram, <span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;VAO)</span></span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>函数体修改：</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setVertixData</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;VBO, <span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;VAO, <span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;EBO)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// set up vertex data (and buffer(s)) and configure vertex attributes</span></span><br><span class="line">    <span class="comment">// ------------------------------------------------------------------</span></span><br><span class="line">    <span class="keyword">float</span> vertices[] = &#123;</span><br><span class="line">        <span class="number">0.5f</span>,  <span class="number">0.5f</span>, <span class="number">0.0f</span>,   <span class="comment">// top right</span></span><br><span class="line">        <span class="number">0.5f</span>, <span class="number">-0.5f</span>, <span class="number">0.0f</span>,   <span class="comment">// bottom right</span></span><br><span class="line">        <span class="number">-0.5f</span>, <span class="number">-0.5f</span>, <span class="number">0.0f</span>,  <span class="comment">// bottom left</span></span><br><span class="line">        <span class="number">-0.5f</span>,  <span class="number">0.5f</span>, <span class="number">0.0f</span>   <span class="comment">// top left</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> indices[] = &#123;  <span class="comment">// note that we start from 0!</span></span><br><span class="line">        <span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>,  <span class="comment">// first Triangle</span></span><br><span class="line">        <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>   <span class="comment">// second Triangle</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    glGenBuffers(<span class="number">1</span>, &amp;VBO);</span><br><span class="line">    glGenBuffers(<span class="number">1</span>, &amp;EBO);</span><br><span class="line">    glGenVertexArrays(<span class="number">1</span>, &amp;VAO);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// bind the Vertex Array Object first, then bind and set vertex buffer(s), and then configure vertex attributes(s).</span></span><br><span class="line">    glBindVertexArray(VAO);</span><br><span class="line"></span><br><span class="line">    glBindBuffer(GL_ARRAY_BUFFER, VBO);</span><br><span class="line">    glBufferData(GL_ARRAY_BUFFER, <span class="keyword">sizeof</span>(vertices), vertices, GL_STATIC_DRAW);</span><br><span class="line"></span><br><span class="line">    glVertexAttribPointer(<span class="number">0</span>, <span class="number">3</span>, GL_FLOAT, GL_FALSE, <span class="number">3</span> * <span class="keyword">sizeof</span>(<span class="keyword">float</span>), (<span class="keyword">void</span>*)<span class="number">0</span>);</span><br><span class="line">    glEnableVertexAttribArray(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, EBO);</span><br><span class="line">    glBufferData(GL_ELEMENT_ARRAY_BUFFER, <span class="keyword">sizeof</span>(indices), indices, GL_STATIC_DRAW);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// note that this is allowed, the call to glVertexAttribPointer registered VBO as the vertex attribute's bound vertex buffer object so afterwards we can safely unbind</span></span><br><span class="line">    glBindBuffer(GL_ARRAY_BUFFER, <span class="number">0</span>);</span><br><span class="line">    glBindVertexArray(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">deleteObj</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;VBO, <span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;VAO, <span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;EBO)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    glDeleteVertexArrays(<span class="number">1</span>, &amp;VAO);</span><br><span class="line">    glDeleteBuffers(<span class="number">1</span>, &amp;VBO);</span><br><span class="line">    glDeleteBuffers(<span class="number">1</span>, &amp;EBO);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">render</span><span class="params">(<span class="keyword">int</span> &amp;shaderProgram, <span class="keyword">unsigned</span> <span class="keyword">int</span> &amp;VAO)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// render</span></span><br><span class="line">    <span class="comment">// ------</span></span><br><span class="line">    glClearColor(<span class="number">0.2f</span>, <span class="number">0.3f</span>, <span class="number">0.3f</span>, <span class="number">1.0f</span>);</span><br><span class="line">    glClear(GL_COLOR_BUFFER_BIT);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// draw our first triangle</span></span><br><span class="line">    glUseProgram(shaderProgram);</span><br><span class="line">    glBindVertexArray(VAO); <span class="comment">// seeing as we only have a single VAO there's no need to bind it every time, but we'll do so to keep things a bit more organized</span></span><br><span class="line">    glDrawElements(GL_TRIANGLES, <span class="number">6</span>, GL_UNSIGNED_INT, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol>
<li><a href="https://learnopengl-cn.github.io/01%20Getting%20started/02%20Creating%20a%20window/" target="_blank" rel="noopener">learnOpenGL CN - 创建窗口</a></li>
<li><a href="https://blog.csdn.net/wangdingqiaoit/article/details/51308622" target="_blank" rel="noopener">OpenGL学习脚印:环境搭建</a></li>
<li><a href="https://learnopengl-cn.github.io/01%20Getting%20started/04%20Hello%20Triangle/" target="_blank" rel="noopener">learnOpenGL CN - 你好，三角形</a></li>
</ol>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://yoursite.com/2018/10/20/现代OpenGL的基本使用/" data-id="cjqwcig2100695cvdaz8qwg10" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-使用python调用OpenGL" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2018/10/18/使用python调用OpenGL/">使用python调用OpenGL</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2018/10/18/使用python调用OpenGL/">
            <time datetime="2018-10-18T13:33:13.000Z" itemprop="datePublished">2018-10-18</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/技术/">技术</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/技术/OpenGL/">OpenGL</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Assimp/">Assimp</a>, <a class="tag-link" href="/tags/GLUT/">GLUT</a>, <a class="tag-link" href="/tags/OpenGL/">OpenGL</a>, <a class="tag-link" href="/tags/pyassimp/">pyassimp</a>, <a class="tag-link" href="/tags/python/">python</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>OpenGL原生接口是C和C++的，不过OpenGL也提供了python版本，在本文中只会演示OpenGL在python中的最简单使用方法，更具体的功能还需要参考相关库的资料。</p>
<p>另外一部分就是介绍3D加载库Assimp，由于实际的项目都是先用3D软件做好模型，再其他地方使用，所以Assimp是OpenGL项目中相对很实用的库，不过其python版本安装相对复杂，所以这里特殊说明。</p>
<h2 id="PyOpenGL安装"><a href="#PyOpenGL安装" class="headerlink" title="PyOpenGL安装"></a>PyOpenGL安装</h2><p>为了用Python使用OpenGL，我们需要安装两个库：</p>
<ul>
<li>PyOpenGL：OpenGL的python接口库</li>
<li>PyOpenGL_accelerate：对PyOpenGL进行加速</li>
</ul>
<p>建议使用conda进行安装，因为conda可以自动安装或更新其他的依赖库如numpy、vs_runtion等等。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda install PyOpenGL</span><br><span class="line">conda install conda install PyOpenGL</span><br></pre></td></tr></table></figure>
<p>PyOpenGL官方文档为：<a href="http://pyopengl.sourceforge.net/documentation/" target="_blank" rel="noopener">http://pyopengl.sourceforge.net/documentation/</a></p>
<h2 id="演示代码"><a href="#演示代码" class="headerlink" title="演示代码"></a>演示代码</h2><p>在PyOpenGL后，可以先用如下简单的代码测试以下，openGL是否能正常工作：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> OpenGL.GL <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> OpenGL.GLU <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> OpenGL.GLUT <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">drawFunc</span><span class="params">()</span>:</span></span><br><span class="line">    glClear(GL_COLOR_BUFFER_BIT)</span><br><span class="line">    glRotatef(<span class="number">0.1</span>, <span class="number">0.1</span>, <span class="number">0.5</span>, <span class="number">0</span>)</span><br><span class="line">    glutWireTeapot(<span class="number">0.5</span>)</span><br><span class="line">    glFlush()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    glutInit()</span><br><span class="line">    glutInitDisplayMode(GLUT_SINGLE | GLUT_RGBA)</span><br><span class="line">    glutInitWindowPosition(<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">    glutInitWindowSize(<span class="number">400</span>, <span class="number">400</span>)</span><br><span class="line">    glutCreateWindow(<span class="string">b'first'</span>)</span><br><span class="line">    glutDisplayFunc(drawFunc)</span><br><span class="line">    glutMainLoop()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">        main()</span><br></pre></td></tr></table></figure>
<p>运行以上代码，得到如下窗口：</p>
<p><img src="/markdownImage/openglteapot.png" alt="teapot"></p>
<h2 id="关于OpenGL的封装库"><a href="#关于OpenGL的封装库" class="headerlink" title="关于OpenGL的封装库"></a>关于OpenGL的封装库</h2><p>在OpenGL中一般的函数命名如下：</p>
<p><strong> &lt;前缀&gt;&lt;根函数&gt;&lt;参数数目&gt;&lt;参数类型&gt; </strong></p>
<p>前缀有gl、glu、aux、glut、wgl、glx、agl等等，分别表示该函数属于OpenGL那个开发库等。所谓开发库，要知道原生的OpenGL是跨平台的，跨平台意味着很多功能是无法统一实现，比如说Windows和X-Window的窗口实现机制是不同的，OpenGL并不关心这些东西，只管画图。所以，基本的OpenGL并没有窗口函数，比如无法创建窗口，无法获得输入等等，这些东西都需要其他的函数库来实现。</p>
<p>在上面的演示代码中我们主要使用两种库，一个是GLU库，它提供了比较基础的命令的封装，可以很简单的实现比较多的复杂功能；而另外一个就是GLUT，glut是不依赖于窗口平台的OpenGL工具包，目的是隐藏不同窗口平台API的复杂度，提供更为复杂的绘制功能。</p>
<p>结合上面的演示代码，可以看到PyOpenGL的用法其实和c++使用原生OpenGL区别非常小。所以更复杂的图形绘制，可以先找c++代码，然后将其变成python代码。</p>
<h2 id="简单Glut的代码框架"><a href="#简单Glut的代码框架" class="headerlink" title="简单Glut的代码框架"></a>简单Glut的代码框架</h2><p>虽然现在glut库基本上被其他库代替，但是在旧版的OpenGL中还是使用得比较多的，其基本代码框架python版本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> OpenGL.GL <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> OpenGL.GLU <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> OpenGL.GLUT <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">userinit</span><span class="params">()</span>:</span></span><br><span class="line">    glClearColor( <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span> )</span><br><span class="line">    glColor4f(<span class="number">1.0</span>,<span class="number">1.0</span>,<span class="number">0.0</span>,<span class="number">0.0</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">drawFunc</span><span class="params">()</span>:</span></span><br><span class="line">    glClear(GL_COLOR_BUFFER_BIT)</span><br><span class="line">    glBegin(GL_TRIANGLES)</span><br><span class="line">    glVertex3f(<span class="number">-0.5</span>,<span class="number">-0.5</span>,<span class="number">0.0</span>)</span><br><span class="line">    glVertex3f(<span class="number">0.5</span>,<span class="number">0.0</span>,<span class="number">0.0</span>)</span><br><span class="line">    glVertex3f(<span class="number">0.0</span>,<span class="number">0.5</span>,<span class="number">0.0</span>)</span><br><span class="line">    glEnd()</span><br><span class="line">    glFlush()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调整窗口大小回调函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reshape</span><span class="params">(w, h)</span>:</span></span><br><span class="line">    glViewport(<span class="number">0</span>,<span class="number">0</span>,w,h);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">keyboardAction</span><span class="params">(key, x, y)</span>:</span></span><br><span class="line">    print(key)</span><br><span class="line">    <span class="keyword">if</span> key == <span class="string">b'q'</span>:</span><br><span class="line">        exit();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    glutInit()</span><br><span class="line">    glutInitDisplayMode(GLUT_SINGLE | GLUT_RGBA)</span><br><span class="line">    glutInitWindowPosition(<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">    glutInitWindowSize(<span class="number">400</span>, <span class="number">400</span>)</span><br><span class="line">    glutCreateWindow(<span class="string">b'first'</span>)</span><br><span class="line"></span><br><span class="line">    userinit()</span><br><span class="line">    <span class="comment"># glutReshapeFunc(reshape)</span></span><br><span class="line">    glutDisplayFunc(drawFunc)</span><br><span class="line">    glutKeyboardFunc(keyboardAction)</span><br><span class="line">    glutMainLoop()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h2 id="3D模型文件与Assimp库"><a href="#3D模型文件与Assimp库" class="headerlink" title="3D模型文件与Assimp库"></a>3D模型文件与Assimp库</h2><p>3D软件生成的模型文件有很多格式，如obj、3ds、c4e等，这些文件主要包含如下内容的数据：</p>
<ul>
<li>定点坐标</li>
<li>法线坐标</li>
<li>纹理坐标</li>
<li>材质、灯光信息</li>
</ul>
<p>如果希望在OpenGL中使用到这些模型，那么就需要对这些模型文件进行解析，对于某些简单的格式如obj，它是文本格式的文件，每一行的首字符作为标记，可以直接读取解析，但是对于复杂的格式就不那么方便了，最好可以使用他人提供的库来加载。</p>
<p>Assimp则是OpenGl中常用的模型加载库，全称 Open Asset Import Library，它支持很多种格式的模型文件。同样它也提供了python版本pyassimp</p>
<h2 id="pyassimp安装"><a href="#pyassimp安装" class="headerlink" title="pyassimp安装"></a>pyassimp安装</h2><p>pyassimpy的安装不一样，我们先使用pip安装后，它仍然是不能导入的，且提示错误：</p>
<p><em>“ pyassimp.errors.AssimpError: assimp library not found”</em></p>
<p>这是因为仅仅这样安装只是安装了其python接口，并没有将assimp库文件安装。通常我们需要下载其源码自己编译，对于windows系统就是编译生成其对应的.dll文件。下载地址：<a href="http://assimp.sourceforge.net/main_downloads.html" target="_blank" rel="noopener">http://assimp.sourceforge.net/main_downloads.html</a></p>
<p>由于assimp使用cmake管理的，所以在编译assmip前，先确保cmake安装。关于cmake在windows下如何于VS协同使用可以参考如下链接：<a href="https://blog.csdn.net/yaoyuanyylyy/article/details/79024962" target="_blank" rel="noopener">CMake入门1——CMake与VS编译器和nmake的结合使用</a>。</p>
<p>在使用cmake配置项目的时候，需要注意python的是64bit还是32bit，如我的是64bit，在选择编译器就要选择对应的VS64bit版本，否则python将仍然无法导入assimp：</p>
<p><img src="/markdownImage/cmake_config.png" alt="cmake"></p>
<p>如果cmake没有选择正确，而在VS中又强制编译另一个版本的库，则编译时会如下如下错误：</p>
<p><em>“&gt;x64\Debug\adler32.obj : fatal error LNK1112: 模块计算机类型“x64”与目标计算机类型“X86”冲突”</em></p>
<p>在编译完成后将生成的.dll库文件如下：</p>
<p><img src="/markdownImage/assimp_lib.png" alt="cmake"></p>
<p>我们需要将其放入到python能够找到的目录下，我是直接放到site-packages/pyassimp的目录下。</p>
<p>完成上面操作后，可以测试运行如下，检查是否成功导入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyassimp</span><br><span class="line"></span><br><span class="line">objpath = <span class="string">r'1.obj'</span></span><br><span class="line">scene = pyassimp.load(objpath)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> len(scene.meshes)</span><br><span class="line">mesh = scene.meshes[<span class="number">0</span>]</span><br><span class="line">print(mesh)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> len(mesh.vertices)</span><br><span class="line">print(mesh.vertices[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">pyassimp.release(scene)</span><br></pre></td></tr></table></figure>
<h2 id="assimp读取模型数据结构"><a href="#assimp读取模型数据结构" class="headerlink" title="assimp读取模型数据结构"></a>assimp读取模型数据结构</h2><p>当导入一个模型文件时，即Assimp加载一整个包含所有模型和场景数据的模型文件到一个scene对象时，Assimp会为这个模型文件中的所有场景节点、模型节点都生成一个具有对应关系的数据结构，且将这些场景中的各种元素与模型数据对应起来。下图展示了一个简化，的Assimp生成的模型文件数据结构：</p>
<p><img src="/markdownImage/assimp.png" alt="assmip"></p>
<p>下载pyassimp源码安装包中，在其中的scripts文件中，提供了使用例子，可以参考其中的代码学习。源码安装地址：<a href="https://pypi.org/project/pyassimp/4.1.3/" target="_blank" rel="noopener">https://pypi.org/project/pyassimp/4.1.3/</a></p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol>
<li><a href="http://eyehere.net/tag/pyopengl/" target="_blank" rel="noopener">用PyOpenGL叩开3D的心扉——OpenGL全解析</a></li>
<li><a href="https://blog.csdn.net/wangdingqiaoit/article/details/51879737" target="_blank" rel="noopener">OpenGL学习脚印:模型加载初步-加载obj模型(load obj model)</a></li>
<li><a href="https://blog.csdn.net/u011371324/article/details/77142121" target="_blank" rel="noopener">Opengl学习之模型加载——Assimp</a></li>
</ol>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://yoursite.com/2018/10/18/使用python调用OpenGL/" data-id="cjqwcig0a003a5cvdv38tjkzg" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-OpenGL初步认识" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2018/10/18/OpenGL初步认识/">OpenGL初步认识</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2018/10/18/OpenGL初步认识/">
            <time datetime="2018-10-18T04:41:44.000Z" itemprop="datePublished">2018-10-18</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/技术/">技术</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/技术/OpenGL/">OpenGL</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/OpenGL/">OpenGL</a>, <a class="tag-link" href="/tags/Shader/">Shader</a>, <a class="tag-link" href="/tags/渲染pipeline/">渲染pipeline</a>, <a class="tag-link" href="/tags/纹理/">纹理</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>关于OpenGL的一些基本认识，以下为两个很好的现代OpenGL教程，其链接以及GitHub代码地址如下：</p>
<ul>
<li>《LearnOpenGL CN》 教程地址：<a href="https://learnopengl-cn.github.io/" target="_blank" rel="noopener">https://learnopengl-cn.github.io/</a>， 代码库地址：<a href="https://github.com/JoeyDeVries/LearnOpenGL" target="_blank" rel="noopener">https://github.com/JoeyDeVries/LearnOpenGL</a></li>
<li>《OpenGL学习脚印》 教程地址：<a href="https://blog.csdn.net/wangdingqiaoit/article/category/2107037/2" target="_blank" rel="noopener">https://blog.csdn.net/wangdingqiaoit/article/category/2107037/2</a>, 代码库地址：<a href="https://github.com/wangdingqiao/noteForOpenGL" target="_blank" rel="noopener">https://github.com/wangdingqiao/noteForOpenGL</a></li>
</ul>
<h2 id="OpenGL的理解"><a href="#OpenGL的理解" class="headerlink" title="OpenGL的理解"></a>OpenGL的理解</h2><p>OpenGL（Open Graphics Library）是用于渲染2D、3D矢量图形的跨语言、跨平台的应用程序编程接口。为了跨平台，实际上狭义上的OpenGL只是一个标准，各种硬件公司遵循其标准来生产硬件，在软件层面上按照该标准也有多种代码实现，所以才会类似GLEW、GLUT、GLFW这些库的存在。</p>
<p>OpenGL是一种客户端-服务器（client-server）类型的系统。我们编写的程序就是一个客户端，而我们的计算机图形硬件制造商提供的OpenGL的实现就是服务器。在一些OpenGL的实现里（例如一些和XWindow System相关的应用），客户端和服务器可能会在不同的机器上运行，中间用网络连接。</p>
<h2 id="状态机"><a href="#状态机" class="headerlink" title="状态机"></a>状态机</h2><p>OpenGL自身是一个巨大的状态机(State Machine)：一系列的变量描述OpenGL此刻应当如何运行。OpenGL的状态通常被称为OpenGL上下文(Context)。假设当我们想告诉OpenGL去画线段而不是三角形的时候，我们通过改变一些上下文变量来改变OpenGL状态，从而告诉OpenGL如何去绘图。一旦我们改变了OpenGL的状态为绘制线段，下一个绘制命令就会画出线段而不是三角形。</p>
<h2 id="基本图形绘制方式"><a href="#基本图形绘制方式" class="headerlink" title="基本图形绘制方式"></a>基本图形绘制方式</h2><h4 id="1-传统方式绘制"><a href="#1-传统方式绘制" class="headerlink" title="1. 传统方式绘制"></a>1. 传统方式绘制</h4><p>传统绘制方式在OpenGL新版本中已经废弃，虽然在兼容模式下还能工作，但不建议使用。传统绘制方式的包括以下两方面的内容：</p>
<ul>
<li>立即模式（Immediate Mode）：使用glBegin…glEnd方式制定绘制方式，在这两个函数对之间给出绘制的数据，固定渲染管线，这种方式称为立即模式</li>
<li>显示列表（Display List）： 显示列表是一组存储在一起的OpenGL函数，可以再以后执行。调用一个显示列表时，它所存储的函数就会按照顺序执行。显示列表通过存储OpenGL函数，可以提高性能。如果需要多次重复绘制同一个几何图形，或者如果有一些需要多次调用的用于更改状态的函数，就可以把他们存储在显示列表中。</li>
</ul>
<h4 id="2-现代绘制方式"><a href="#2-现代绘制方式" class="headerlink" title="2. 现代绘制方式"></a>2. 现代绘制方式</h4><p>现代的绘制方式主要有三种方法：</p>
<ul>
<li>顶点数组绘图：使用顶点数组方式，需要利用glEnableClientState开启一些特性，这里开启顶点数组特性使用glEnableClientState(GL_VERTEX_ARRAY)。使用顶点数组时，用户定义好存储顶点的数据，在调用glDrawArrays、glDrawElements之类的函数时，通过glVertexPointer设定的指针，传送数据到GPU。当调用完glDrawArrays后，GPU中已经有了绘图所需数据，用户可以释放数据空间。</li>
<li>VBO和VAO绘图：VAO即Vertex Array Object，是一个包含一个或多个VBO的对象，被设计用来存储一个完整被渲染对象所需的信息。VBO即Vertex Buffer Object，是一个在高速视频卡中的内存缓冲，用来保存顶点数据,也可用于包含诸如归一化向量、纹理和索引等数据。</li>
<li>结合Shader绘图</li>
</ul>
<p>在旧版本的OpenGL中，是通过glVertex，glTexCoord和glNormal函数把每帧数据发送给GPU的。在现代OpenGL中，所有数据必须通过VBO在渲染之前发送给显卡。当你需要渲染某些数据时，通过设置VAO来描述该获取哪些VBO数据推送给shader变量。</p>
<h4 id="3-各种中绘图方式利弊"><a href="#3-各种中绘图方式利弊" class="headerlink" title="3. 各种中绘图方式利弊"></a>3. 各种中绘图方式利弊</h4><ol>
<li>使用立即模式，缺点很明显，数据量大一点的话，代码量增加，而且数据发送到服务端需要开销</li>
<li>使用显示列表，显示列表是一个服务端函数，因此它免除了传送数据的额外开销。但是，显示列表一旦编译后，其中的数据无法修改</li>
<li>使用顶点数组，可以减少函数调用和共享顶点数据的冗余。但是，使用顶点数组时，顶点数组相关函数是在客户端，因此数组中数据在每次被解引用时必须重新发送到服务端，额外开销不可忽视</li>
<li>使用VBO在服务端创建缓存对象，并且提供了访问函数来解引用数组，如：例如在顶点数组中使用的函数如glVertexPointer(),glNormalPointer(), glTexCoordPointer()；另外，不像显示列表，VBO中数据可以通过映射到客户端内存空间而被用户读取和更新；VBO的另外一个优势是它像显示列表和纹理一样，能和多个客户端共享缓存对象。可见使用VBO优势很明显</li>
</ol>
<h2 id="OpenGL-pipeline"><a href="#OpenGL-pipeline" class="headerlink" title="OpenGL pipeline"></a>OpenGL pipeline</h2><p>3D坐标转为2D坐标的处理过程是由OpenGL的图形渲染管线（Graphics Pipeline，大多译为管线，实际上指的是一堆原始图形数据途经一个输送管道，期间经过各种变化处理最终出现在屏幕的过程）管理的。图形渲染管线可以被划分为两个主要部分的作用：第一部分把你的3D坐标转换为2D坐标，第二部分是把2D坐标转变为实际的有颜色的像素。</p>
<p>具体到不同版本的OpenGL中pipeline的过程会有不同，现代OpenGL程序中允许用户自己定制着色器，这使得绘图更灵活，下面是一个比较典型的示意图：</p>
<p>其中：顶点着色器和片元着色器是OpenGL整个渲染管线必须要有的过程，其他的着色器可以根据需要进行选择，图元是基本的绘制形状，如点、线、三角形；另外除了第一阶段准备定点数据是在CPU中做，其他的一般都是在GPU中工作的。</p>
<p><img src="/markdownImage/openglpipeline.jpg" alt="opengl pipeline"></p>
<p>其中顶点着色器（Vertex Shader）比较重要，通常会有如下作用：</p>
<ul>
<li>顶点变换 根据模型视图和投影矩阵变换</li>
<li>光照计算</li>
<li>纹理坐标变换(纹理矩阵)</li>
<li>材质状态、纹理坐标生成</li>
</ul>
<h2 id="Shaders"><a href="#Shaders" class="headerlink" title="Shaders"></a>Shaders</h2><p>Shaders在现代OpenGL中是个很重要的概念。Shaders是一段GLSL小程序，运行在GPU上而非CPU。它们使用OpenGL Shading Language (GLSL)语言编写，看上去像C或C++，但却是另外一种不同的语言。使用shader就像你写个普通程序一样：写代码，编译，最后链接在一起才生成最终的程序。在旧版本的OpenGL中，shaders是可选的，在现代OpenGL中，为了能在屏幕上显示出物体，shaders是必须的。</p>
<p>Shader的中文是着色器，但是它的作用不仅仅只做着色，shaders实际上干了啥，这取决于是哪种shader。</p>
<h2 id="纹理"><a href="#纹理" class="headerlink" title="纹理"></a>纹理</h2><p>要使渲染的物体更加逼真，一方面我们可以使用更多的三角形来建模，通过复杂的模型来逼近物体，但是这种方法会增加绘制流水线的负荷，而且很多情况下不是很方便的。使用纹理，将物体表面的细节映射到建模好的物体表面，这样不仅能使渲染的模型表面细节更丰富，而且比较方便高效。纹理映射就是这样一种方法，在程序中通过为物体指定纹理坐标，通过纹理坐标获取纹理对象中的纹理，最终显示在屏幕区域上，已达到更加逼真的效果。</p>
<h2 id="光照"><a href="#光照" class="headerlink" title="光照"></a>光照</h2><p>要模拟现实的光照是困难的，例如实际光照中，一束光可以经过场景中若干物体反射后，照射到目标物体上，也可以是直接照射到目标物体上。其中经过其他物体反射后再次照射到目标物体上，这是一个递归的过程，将会无比复杂。因此实际模拟光照过程中，总是采用近似模型去接近现实光照。Phong Reflection Model是经典的光照模型，它计算光照包括三个部分：环境光+漫反射光+镜面光。</p>
<ul>
<li>环境光：环境光是场景中光源给定或者全局给定的一个光照常量，它一般很小，主要是为了模拟即使场景中没有光照时，也不是全部黑屏的效果</li>
<li>漫反射光：漫反射光成分，是光照中的一个主要成分，漫反射光强度与光线入射方向和物体表面的法向量之间的夹角相关</li>
<li>镜面反射光：镜面光成分模拟的是物体表面光滑时反射的高亮的光，镜面光反映的通常是光的颜色，而不是物体的颜色，计算镜面光成分时，要考虑光源和顶点位置之间向量L、法向量N、反射方向R、观察者和顶点位置之间的向量V之间的关系</li>
</ul>
<p>我们实现的光照计算是在片元着色器中进行的，这种是基于片元计算的，称之为Phong<br>shading，在过去OpenGL编程中实现的是在顶点着色器中进行光照计算,这是基元顶点的计算的，称之为Gouraud Shading。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol>
<li><a href="https://blog.csdn.net/wangdingqiaoit/article/details/38920103" target="_blank" rel="noopener">OpenGL学习脚印:基本图形绘制方式比较</a><br>2.<a href="https://blog.csdn.net/candycat1992/article/details/39675513" target="_blank" rel="noopener">【OpenGL】理解一些基本问题</a></li>
<li><a href="https://www.cnblogs.com/pengjun-shanghai/p/9041530.html" target="_blank" rel="noopener">OpenGL渲染管线（rendering pipeline）</a></li>
<li><a href="https://www.khronos.org/opengl/wiki/Rendering_Pipeline_Overview" target="_blank" rel="noopener">Rendering Pipeline Overview</a></li>
<li><a href="https://blog.csdn.net/wangdingqiaoit/article/details/51318793" target="_blank" rel="noopener">OpenGL学习脚印:绘制一个三角形</a></li>
<li><a href="https://blog.csdn.net/wangdingqiaoit/article/details/51638260" target="_blank" rel="noopener">OpenGL学习脚印: 光照基础(basic lighting)</a></li>
<li><a href="http://huangwei.pro/2015-05/modern-opengl1/" target="_blank" rel="noopener">现代OpenGL教程 01 - 入门指南</a></li>
<li><a href="https://learnopengl-cn.github.io/01%20Getting%20started/01%20OpenGL/" target="_blank" rel="noopener">learnOpenGL CN - OpenGL</a></li>
<li><a href="https://learnopengl-cn.github.io/01%20Getting%20started/04%20Hello%20Triangle/" target="_blank" rel="noopener">learnOpenGL CN - 你好，三角形</a></li>
</ol>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://yoursite.com/2018/10/18/OpenGL初步认识/" data-id="cjqwcifyz000s5cvduqaezz0p" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-GMM高斯混合模型的使用" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2018/07/13/GMM高斯混合模型的使用/">GMM高斯混合模型的使用</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2018/07/13/GMM高斯混合模型的使用/">
            <time datetime="2018-07-13T04:17:10.000Z" itemprop="datePublished">2018-07-13</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/技术/">技术</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/技术/机器学习/">机器学习</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/EM算法/">EM算法</a>, <a class="tag-link" href="/tags/GMM/">GMM</a>, <a class="tag-link" href="/tags/机器学习/">机器学习</a>, <a class="tag-link" href="/tags/高斯混合模型/">高斯混合模型</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在了解过EM算法后，再来看GMM就轻松多了，当然对于我来说除了GMM的基本原理外，更重要的是需要利用GMM算法来做视频的运动检测。</p>
<h2 id="GMM简介"><a href="#GMM简介" class="headerlink" title="GMM简介"></a>GMM简介</h2><p>GMM是Gaussian Mixed Model的简称，中文名为高斯混合模型，基本原理其实十分简单，就是用多个不同的高斯模型线性叠加来拟合实际的数据分布。如下图为截取网友介绍GMM博文的图像，其中使用了两个高斯分布来拟合的实际的数据点分布：</p>
<p><img src="/markdownImage/GMM.png" alt="GMM"></p>
<p>假定有随机变量x，混合高斯模型的公式表达形式为：</p>
<p><img src="/markdownImage/GMM_math.jpg" alt="GMM公式"></p>
<p>p(x)表示x发生的概率，它由K个不同的高斯分布组成，πk相当于每个分量的权重，详细说明可以看参考中第一篇博文的说明。</p>
<h2 id="GMM和EM算法"><a href="#GMM和EM算法" class="headerlink" title="GMM和EM算法"></a>GMM和EM算法</h2><p>虽然GMM的基本原理很简单，但是使用GMM要得到估计的最佳结果却不容易，对上图来说就就是两个高斯的均值、方差以及各自占的权重。为了计算得到GMM的最优的估计参数就需要使用到EM算法，所以理解GMM方法的难点实际上是需要理解EM算法在GMM中的使用，而实际上EM算法真是不是那么好理解。</p>
<p>对于EM算法我在上篇单独做了简要的说明，我们可以看到GMM这样的形式非常适合用EM算法来就解，因为EM算法来说就是为了解决由于隐变量的存在导致目标参数相互影响的问题的方法，在GMM中这个隐变量就是每个高斯分量的类型；另外GMM的每个分量的形式都是已知的，都是高斯分布，所以使用EM算法计算最大似然也是非常方便。</p>
<h2 id="使用GMM做检测视频的运动检测"><a href="#使用GMM做检测视频的运动检测" class="headerlink" title="使用GMM做检测视频的运动检测"></a>使用GMM做检测视频的运动检测</h2><p>在视频处理中GMM是一种非常常用且有效的运动检测方法，它的主要作用是将场景中的前景和背景分离。它是对图像的每个像素建立多个高斯模型，每个模型包含均值、方差、权值和匹配数4个参数，我们可以看到，除了匹配数其他参数都是上面公式里包含了的。在GMM使用前需要设置好高斯模型的个数，这是需要人为指定的。然后根据第一帧图像初始化第一个高斯模型的参数，而其他的高斯模型则使用0初始化。</p>
<p>在后续帧输入时，使用当前图像的每个像素值对于其对应的高斯模型进行匹配，一种匹配的方法是：计算当前像素值与要匹配的高斯模型的偏离均值的大小，若小于阈值则匹配成功。完成匹配的操作后，使用新匹配的数据更新模型的参数，最后进行高斯模型排序，不过这个排序是根据权值方差来定的，具体可以看参考链接2。</p>
<p>图像的背景为每个像素的灰度值其对应的第一个高斯模型的平均值，当当前图像像素值与已存在的第k个高斯模型匹配，并且前k-1个高斯模型的权值之和小于阈值bg_threshold ，则将当前像素归为背景，像素值设为0，否则归为前景，像素值设为255。</p>
<h2 id="在opencv中的使用"><a href="#在opencv中的使用" class="headerlink" title="在opencv中的使用"></a>在opencv中的使用</h2><p>GMM在opencv中有对应的算法实现：BackgroundSubtractorMOG和BackgroundSubtractorMOG2，BackgroundSubtractorMOG2是在BackgroundSubtractorMOG的改进，具体可以查看opencv的文档。</p>
<p>opencv的官方文档中提供了简单的使用实例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line"></span><br><span class="line">cap = cv.VideoCapture(<span class="string">'vtest.avi'</span>)</span><br><span class="line"></span><br><span class="line">fgbg = cv.createBackgroundSubtractorMOG2()</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    ret, frame = cap.read()</span><br><span class="line"></span><br><span class="line">    fgmask = fgbg.apply(frame)</span><br><span class="line"></span><br><span class="line">    cv.imshow(<span class="string">'frame'</span>,fgmask)</span><br><span class="line">    k = cv.waitKey(<span class="number">30</span>) &amp; <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> k == <span class="number">27</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">cap.release()</span><br><span class="line">cv.destroyAllWindows()</span><br></pre></td></tr></table></figure>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol>
<li><a href="https://blog.csdn.net/jinping_shi/article/details/59613054" target="_blank" rel="noopener">高斯混合模型（GMM）及其EM算法的理解</a></li>
<li><a href="https://blog.csdn.net/sinat_25885063/article/details/44197885" target="_blank" rel="noopener">OpenCV之基于GMM的运动目标检测</a></li>
</ol>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://yoursite.com/2018/07/13/GMM高斯混合模型的使用/" data-id="cjqwcifyk000a5cvdbyxue82s" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-EM算法理解" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2018/07/09/EM算法理解/">EM算法理解</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2018/07/09/EM算法理解/">
            <time datetime="2018-07-09T04:10:05.000Z" itemprop="datePublished">2018-07-09</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/技术/">技术</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/技术/机器学习/">机器学习</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/EM算法/">EM算法</a>, <a class="tag-link" href="/tags/GMM/">GMM</a>, <a class="tag-link" href="/tags/机器学习/">机器学习</a>, <a class="tag-link" href="/tags/高斯混合模型/">高斯混合模型</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这几天开始研究一些视频处理的算法，在学习GMM（高斯混合模型）时硬是弄不懂其优化原理，什么E步、什么M步完全搞不懂，到最后才发现其实GMM是使用了EM算法进行优化求解，但是大多数介绍GMM的文章是不会仔细说明EM算法的，所以我在不了EM算法的情况下能懂才怪了，更何况EM算法本身就一个难理解的东西。</p>
<h2 id="两篇介绍EM算法优秀博文"><a href="#两篇介绍EM算法优秀博文" class="headerlink" title="两篇介绍EM算法优秀博文"></a>两篇介绍EM算法优秀博文</h2><p>EM算法是Expectation Maximization Algorithm的简称，中文可以翻译为期望最大化算法，它是一种基于统计估计的迭代算法，它能够用在一些无监督的方法上。关于EM算法我在网上找到了两篇非常好的文章：</p>
<ol>
<li><a href="https://www.cnblogs.com/mindpuzzle/p/3659444.html" target="_blank" rel="noopener">EM算法(Expectation Maximization Algorithm)</a></li>
<li><a href="https://www.jianshu.com/p/1121509ac1dc" target="_blank" rel="noopener">如何感性地理解EM算法？</a></li>
</ol>
<p>第一篇博客，作者从实例出发，一步步非常详细的推理、论证和说明EM算法的基本原理，甚至连需要的数学背景知识都有简要的介绍。这篇文章最让我敬佩得就是，作者认真细致得写作态度，各种数学公式、图片、文本格式都是是否的整洁和漂亮，而从内容上来看，这也许是EM算法总结得最完善、最严谨的中文学习博客了。但是说实话，在看完这篇文章后，我仍然时一头雾水，因为数学公式太多了看得晕，直到我看完第二篇博客。其实我们从标题也可以看出，第二篇博客作者的目的就是希望读者能够更加直观的理解EM算法，所以在第二篇在这篇博文中，基本上没有数学公式，只有最基本的概率计算。同时作者使用最简单的例子由浅入深，从不同的层次带领读者直观的体验EM算法处理问题的思路和方法，所以阅读时建议先看第二篇再看第一篇。</p>
<p>这两篇文章分别从两个不同的角度将EM算法说明得非常得详尽了，在我看来因该称得上是初学者学习EM算法的最佳资料了。甚至在看过这两篇文章，我觉得已经没有再次总计的必要了，因为该说的东西这两篇文章都说了。不过我还是想自己记录一下，一方面是基于这两篇文章中的难点内容做一些进一步的说明，另一方面则是记录一些我自己的理解。</p>
<h2 id="关于隐变量的理解"><a href="#关于隐变量的理解" class="headerlink" title="关于隐变量的理解"></a>关于隐变量的理解</h2><p>EM算法中比较关键的一点就是要理解隐变量是什么东西。以上面两篇博文里面都提到的硬币为例，在两硬币的例子里每组投掷同一个硬币多次，我们能观测到了每组硬币的投掷的结果，但是却不知道每组投掷的是哪一个硬币，这里每次投掷的硬币类型就是隐变量；而在三硬币模型里，每组投两个硬币1次，第一硬币是已知的，第二个硬币要根据第一个硬币的结果来确定，所以第二个硬币的类型（或者说是第一个硬币的投掷结果）就隐变量。</p>
<p>从以上我们可以看到，一般我们能通过观测事件发生的结果，来预测事件发生的概率，但是如果观察的结果是受到令一个事件的影响的话，我们可能就没法直接估计了。所以我们需要先估计隐变量，然后再估计我们需要的结果，这就是EM算法中需要引入隐变量的意义。</p>
<h2 id="EM算法流程"><a href="#EM算法流程" class="headerlink" title="EM算法流程"></a>EM算法流程</h2><p>在前面的博文中有提到EM算法分两个步骤：E步和M步，不过再开始之前，我们需要对最终的结果分布假定一个初值，在初值的基础上进行E步：利用初值计算估计每组观察隐变量的分布，然后M步：对E步得到的隐变量分布和原始观察结果，计算其log似然函数的最大值，计算结果更新初值，重复迭代。</p>
<p>在M步求解最大值的时候，可以求参数的的偏导数为0，得到结果，如果不方便计算也可以用梯度下降得到近似解。</p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://yoursite.com/2018/07/09/EM算法理解/" data-id="cjqwcifyk00055cvdihvddban" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-全卷积神经网络FCN介绍" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2018/06/18/全卷积神经网络FCN介绍/">全卷积神经网络FCN介绍</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2018/06/18/全卷积神经网络FCN介绍/">
            <time datetime="2018-06-18T07:21:16.000Z" itemprop="datePublished">2018-06-18</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/技术/">技术</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/技术/深度学习/">深度学习</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/CNN/">CNN</a>, <a class="tag-link" href="/tags/FCN/">FCN</a>, <a class="tag-link" href="/tags/deep-learning/">deep learning</a>, <a class="tag-link" href="/tags/神经网络/">神经网络</a>, <a class="tag-link" href="/tags/语义分割/">语义分割</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>FCN是Fully Convolutional Networks的缩写，中文即为全卷积神经网络，虽然从字面上看FCN只是在CNN的基础上把原来不是卷积的网络层换成卷积层，但是FCN出现的作用远远不是从这字面上的意思能够传达的。另一方面，当我们在查看FCN资料的时候，总是会看到大家都将它与semantic segmentation（语义分割）绑在一起说明，这显然这不是偶然，这是因为FCN本来就是为更好的使用神经网络解决semantic segmentation问题，在CVPR 2015拿到best paper候选的论文：<a href="https://arxiv.org/abs/1411.4038" target="_blank" rel="noopener">Fully Convolutional Networks for Semantic Segmentation</a>中首次提出的。</p>
<p>那么什么是semantic segmentation语义分割呢？在我的理解中语义分割是更高层次的图像分割，相比图像分割只是简单的将图像分成不同区块碎片，语义分割要求分割的物体是由意义的整体。如下图，语义分割能够在整张图像中识别分离出自行车和人，而图像分割则不能达到这一目标，只能分割出意义不明的区域。</p>
<p><img src="/markdownImage/semanticSegmentation1.jpg" alt="semantic segmentation"></p>
<h2 id="CNN和语义分割"><a href="#CNN和语义分割" class="headerlink" title="CNN和语义分割"></a>CNN和语义分割</h2><p>正如我们提到机器学习就想到回归和分类一样（当然深度学习更加注重分类问题），当我们提到CNN就肯定会将它与图像分类问题联系在一起。确实CNN在处理图像分类问题上是非常强大的，但是毕竟图像分类问题太单一了，在复杂的视觉应用场景中，仅仅通过图像分类是远远达不到最终的目标的，那么我们是否能够用CNN来解决其他方面的图像处理的任务呢，如语义分割？</p>
<p>答案当然是可以的，基于CNN的分割的做法是：对每个像素点，都使用其领域块作为图像导入到CNN中做一次计算，得到预测分类的结果，把相同分类的像素点分离出来就完成了分割。这样做的缺点是：1. 存储开销大；2. 计算效率低，相邻像素的是分开预测导致很多计算是重复的；3. 像素领域块的大小限制了感知区。</p>
<p>从另外一个角度去分析，CNN在图像分类任务中做得很好，主要原因是CNN的多层结构能够让其能够从浅层特征中提取得到更加抽象的特征，这些高级的特征可以降低空间位置、大小、角度的因素的影响，这对于识别和分类帮助很大。但是高度的抽象也让它让丢失了对物体细节的描叙，另外经典的CNN在卷积层之后使用全连接层得到固定长度的特征向量进行分类，全连接层进一步的丢失了图像的空间信息。正是如此，CNN要做到像素级的分割任务就很有难度了。</p>
<h2 id="FCN对CNN的改进"><a href="#FCN对CNN的改进" class="headerlink" title="FCN对CNN的改进"></a>FCN对CNN的改进</h2><h4 id="1-将全连接层改为卷积层"><a href="#1-将全连接层改为卷积层" class="headerlink" title="1. 将全连接层改为卷积层"></a>1. 将全连接层改为卷积层</h4><p>FCN在CNN的基础上对明显的改变就是，将原来CNN接近输出端的全连接层都改为卷积层。</p>
<p>在神经网络计算时，全连接层和卷积层之间不同点就是，卷积层中的神经元只与输入数据中的一个局部区域连接，并且在同一层上卷积核的参数对这层上的所有神经元是共享的。由于其计算形式的都是点积，所以两者实际上是可以转化的。我们可以用nxnxN的卷积核来代替一个前面是nxnxK的tensor链接上有N个神经元的全连接层，而两者是等价的。</p>
<p>将全连接层换成卷积层后有什么好处呢？</p>
<ol>
<li>首先就是不再限制输入图像尺寸的大小，因为原来是全连接的神经元数量是固定的，输入尺寸不对计算出错；但是换成卷积后，由于卷积层是共享权值的，所以即使输入尺寸不对，卷积运算依旧可以进行。</li>
<li>其次就是可以在同一次网络的前向计算中得到不同区域的结果，这正是由于FCN不再限定输入图像尺寸的结果，所以当我们用大尺寸的图像做输入时，得到的结果不是一个分类或特征结果，而是一个分类图或者特征图（在FCN一般叫heatmap），这个图分别代表着输入图中对应的各个区域经过网络计算预测的结果。这样比起必须将原始大图分成不同区域输入到网络中重复计算才能得到各部分结果的CNN的要高效多了。</li>
</ol>
<p>下图为FCN和CNN的对比结果：</p>
<p><img src="/markdownImage/FCN.jpg" alt="FCN VS CNN"></p>
<h4 id="2-将上采样的加入的网络中"><a href="#2-将上采样的加入的网络中" class="headerlink" title="2. 将上采样的加入的网络中"></a>2. 将上采样的加入的网络中</h4><p>当我们换掉的全连接层后，就解除了很多限制，前面我们就讲了我们将不再限定输入图像的尺寸。那么进一步我们希望输出的也不仅仅是一个数值或一组数值结果，而是一张图像，这对于像语义分割在内的像素级的图像处理任务是非常有利的。</p>
<p>以语义分割为例，我一般会希望得到一张与原图像同样尺寸的已经分割好的图像，那么应该怎么得到这样的结果呢？我们知道图像经过的卷积和池化后，尺寸会越来越小、特征会越来越多，最后一层卷积层输出的结果在FCN中被称为heatmap热图。为了输出原始图像的尺寸，我们需要在heatmap后面加入上采样层，将heatmap放大到原图尺寸，并且利用heatmap中高维的特诊信息确定放大后像素的分类，这就是一个end-to-end（端到端）的系统。</p>
<p>关于上采样具体是怎么实现的，我自己也还没有理解得很清楚，但是原理上可以肯定确定的，上采样一般使用的是双线性插值，然后通过卷积进行预测分类来实现的。</p>
<h4 id="3-skip-layers"><a href="#3-skip-layers" class="headerlink" title="3. skip layers"></a>3. skip layers</h4><p>直接从最后的卷积层的结果上采样会得到图像时比较粗糙的，为了得到更加精细的结果，一般采用skip layer的方法，对浅层的卷积输出的结果进行减小步长的upsampling，得到的fine layer和高层得到的coarse layer做融合。如下图所示：</p>
<p><img src="/markdownImage/skipLayer.jpg" alt="skip layer"></p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol>
<li><a href="https://blog.csdn.net/tangwei2014/article/details/46882257" target="_blank" rel="noopener">论文阅读笔记：Fully Convolutional Networks for Semantic Segmentation</a></li>
<li><a href="https://blog.csdn.net/taigw/article/details/51401448" target="_blank" rel="noopener">全卷积网络（FCN）与图像分割</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/30195134" target="_blank" rel="noopener">全卷积网络 FCN 详解</a></li>
<li><a href="https://www.cnblogs.com/daihengchen/p/6345041.html" target="_blank" rel="noopener">谈一谈深度学习之semantic Segmentation</a></li>
</ol>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://yoursite.com/2018/06/18/全卷积神经网络FCN介绍/" data-id="cjqwcig0a003g5cvd16uq2335" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-对极几何的理解" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2018/06/18/对极几何的理解/">对极几何的理解</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2018/06/18/对极几何的理解/">
            <time datetime="2018-06-18T07:09:31.000Z" itemprop="datePublished">2018-06-18</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/技术/">技术</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/技术/机器视觉/">机器视觉</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/双目视觉/">双目视觉</a>, <a class="tag-link" href="/tags/基础矩阵/">基础矩阵</a>, <a class="tag-link" href="/tags/对极几何/">对极几何</a>, <a class="tag-link" href="/tags/本质矩阵/">本质矩阵</a>, <a class="tag-link" href="/tags/机器视觉/">机器视觉</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>关于对极几何，从去年最开始接触视觉SLAM的时候就经常看到，那时候还以为它是一门几何学科，觉得要了解一门新的学科范围太大，于是就鸽了没有去看。最近开始研究立体视觉，这次是躲是不过了，开始学习吧。查过一通资料才恍然大悟，原来这东西哪是是什么新学科，只是一种特定情况下的几何模型而已，所以这些专有名词就是喜欢吓唬人。</p>
<p>不过话虽然是这样说，但是我丝毫也没有看轻它的意思，在多角度视觉成像的分析中，对极几何其研究基础。</p>
<h2 id="对极几何是什么？"><a href="#对极几何是什么？" class="headerlink" title="对极几何是什么？"></a>对极几何是什么？</h2><p>在我查找的资料中，我觉得比较好的解释是：对极几何是相机在两个不同的位置生成的两幅图像，其拍摄位置和生成图像之间的特殊几何关系。其基本几何模型如下图所示：</p>
<p><img src="/markdownImage/epipolar.png" alt="基本几何"></p>
<h2 id="对极几何有什么用？"><a href="#对极几何有什么用？" class="headerlink" title="对极几何有什么用？"></a>对极几何有什么用？</h2><p>在介绍对几何详细概念前，我想先说一下它有什么用，这是我在写这这篇文章的时候一直在想的问题，从单纯的概念解释并不是那么直接就理解到它的应用场景，那对极几何有什么用呢？</p>
<p>其一就是立体匹配问题，对于已知两视角空间位置关系的情况下，由于对极几何这个几何模型限定的约束条件，使得在立体图像对上搜索空间上的分别在两个图像中的位置只需要相应的对极线上找，把原来的二维搜搜问题，直接简化为一维搜索，双目测距就是这方面得应用之一。</p>
<p>其二就是确定两个拍摄点相对位置与姿态问题，在未知视角位置的情况下，通过搜索图像对中的匹配点，可以求得两个位置和姿态得相对关系，这一点常用在机器人导航、地图得生成、三维重建等方面。</p>
<h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><ul>
<li>极点（Epipoles）：两个相机得基线与两个成像平面得交点，如上图中的e0、e1</li>
<li>极线（Epipolar Lines）：空间中点在成像平面上的投影点与极点的连线，如上图中的l0、l1</li>
<li>极平面（Epipolar Plane）：空间中的点与两个相机的光轴中心点所组成的平面，如上图c0、c1、p所在的面</li>
</ul>
<h2 id="对极约束、基础矩阵和本质矩阵"><a href="#对极约束、基础矩阵和本质矩阵" class="headerlink" title="对极约束、基础矩阵和本质矩阵"></a>对极约束、基础矩阵和本质矩阵</h2><p>对于对极几何，通过上图的几何模型，我们能得到不少有用的结论，但是去除那些细枝末节的东西，其实只有对极约束这个性质才是描叙对极几何最本质特点的性质。</p>
<h4 id="对极约束"><a href="#对极约束" class="headerlink" title="对极约束"></a>对极约束</h4><p>如下图所示，假定相机参数已知，那么对于空间中P点，它将和两个相机的中心点O1和O2，唯一确定对极几何的几何关系，极点、极线、极平面都将确定，而对极约束描叙的就是：<strong>在平面1上成像为p的所有空间点，其必定投影在平面2的极线上，反之亦然。</strong></p>
<p><img src="/markdownImage/epipolar_constraint.png" alt="epipolar_constraint"></p>
<p>在实际应用中，我们可以直接使用这条性质，但是却不是那么的直接，所以在数学上我们引入的基础矩阵和本质矩阵，用一个非常简洁的等式就概括这样一个关系。我发现有一个很有意思的现象：往往数学的描叙是不直接、更难理解的，但是在这里我反倒觉得使用了基础矩阵或本质矩阵的等式是更直接、更清晰的。</p>
<h4 id="基础矩阵和本质矩阵"><a href="#基础矩阵和本质矩阵" class="headerlink" title="基础矩阵和本质矩阵"></a>基础矩阵和本质矩阵</h4><p>为了表示对极约束中在两个成像平面上的点的相对关系，在数学上我们只需要加入一个矩阵（本质矩阵或者基础矩阵）就可以简洁的写出两者的等式关系。</p>
<p>对于本质矩阵E其矩阵等式为：</p>
<p>$pl^T E pr = 0$</p>
<p>对于基础矩阵F其矩阵等式为：</p>
<p>$cl^T F cr = 0$</p>
<p>其中pl和cl表示空间中的点投影在左视图的位置，pr和cr为其投影在右视图中的位置，p和c表示视图中的点在不同坐标下的表示。根据上面的任意一个等式，当我们已知空间中一点在左右视图中的两个位置坐标和基础矩阵（或本质矩阵）这三个中的两者，我们就能够计算得到第三个未知量（对于求E和F来说，可能需要多个点联立求解，因为这两个矩阵中的未知量比较多）。</p>
<h4 id="本质矩阵（Essential-Matrix）"><a href="#本质矩阵（Essential-Matrix）" class="headerlink" title="本质矩阵（Essential Matrix）"></a>本质矩阵（Essential Matrix）</h4><p>上面两式，我们可以看到其等式形式是一模一样的，唯一的区别就在于，两种是在不同坐标系中的表达。本质矩阵E连接的是不同视角下摄像机坐标系下两个投影点的关系，所以pl和pr是在摄像机坐标系下的坐标。</p>
<p>假定两个投影平面的坐标系转化为：旋转R和平移T，那么本质矩阵E与R和T由如下关系（公式推导就省略了）：</p>
<p>$ E = [T_x] \cdot R$</p>
<p>其中(向量叉乘转矩阵的方法)：</p>
<p>$ [T_x] \cdot R = T \times R$</p>
<h4 id="基础矩阵（Fundamental-Matrix）"><a href="#基础矩阵（Fundamental-Matrix）" class="headerlink" title="基础矩阵（Fundamental Matrix）"></a>基础矩阵（Fundamental Matrix）</h4><p>基础矩阵F链接的是在图像坐标系下两个视图图像中的坐标像素坐标的关系，所以cl和cr是图像的像素坐标。我们知道从摄像机坐标系到图像的像素坐标系，是由摄像机的内参矩阵K来确定的，因此基础矩阵与旋转矩阵R和平移向量T之间的关系还需要有摄像机的内参矩阵加入：</p>
<p>$ F = Kl^{-T} \cdot [T_x] \cdot R \cdot Kr^{-1}$</p>
<p>显然其与本质矩阵的关系如下：</p>
<p>$ F = Kl^{-T} \cdot E \cdot Kr^{-1}$</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p>1.<a href="https://www.cnblogs.com/clarenceliang/p/6704970.html" target="_blank" rel="noopener">对极几何（EpipolarGeometry）</a></p>
<ol start="2">
<li><a href="https://www.cnblogs.com/sunny-li/p/7500541.html" target="_blank" rel="noopener">二视图从运动到结构—-对极几何和基础矩阵</a></li>
</ol>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://yoursite.com/2018/06/18/对极几何的理解/" data-id="cjqwcig1600565cvdnu744vej" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-SpatialTransformerNetwork了解" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2018/05/26/SpatialTransformerNetwork了解/">Spatial Transformer Network了解</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2018/05/26/SpatialTransformerNetwork了解/">
            <time datetime="2018-05-26T08:01:50.000Z" itemprop="datePublished">2018-05-26</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/技术/">技术</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/技术/深度学习/">深度学习</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/STN/">STN</a>, <a class="tag-link" href="/tags/Spatial-Transformer-Network/">Spatial Transformer Network</a>, <a class="tag-link" href="/tags/deep-learning/">deep learning</a>, <a class="tag-link" href="/tags/神经网络/">神经网络</a>, <a class="tag-link" href="/tags/空间变换/">空间变换</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近在看深度神经网络论文的时候，遇到了STN这个名词完全不知道是什么东西，后面搜索后才知道这个原来是Spatial Transformer Network的缩写，一种能做空间变换的神经网络结构。这可让我长见识了，在我的认知中一直以为卷积神经网路就只是一层一层的做图像的特征提取，没想到空间仿射变换也能用神经网络去做。我觉得详细了解其实现细节对于我理解论文后面的内容是很有必要的，所以将学习的一些知识点记录在这篇文章中。</p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Spatial Transformer Network是Google旗下的DeepMind的四位剑桥Phd研究员在2015年他们的论文中提出来的，他们针对CNN的特点，构建了一个新的局部网络层，称为空间变换层，它能将输入图像做任意空间变换。</p>
<p>我们知道在传统图像处理中空间变换是很重要的，因为图像本来就是空间中的物体在平面上的投影，而在不同视角得到的图像是不一样的，通过空间变换我们能够建立其相同场景在不同视角的位置和姿态的关系，在识别上我们希望我们的识别算法能够在各种不同的视角的图像识别出同样的物体。STN则为我们提供一种通过构建简单神经网络的方法来实现空间变换的方法，这样我们能够利用现有强大的神经网络训练方法来解决和优化各种空间变换问题，这是我个人觉得STN非常有价值的地方。</p>
<p>另外，STN 能够在没有标注关键点的情况下，根据任务自己学习图片或特征的空间变换参数，将输入图片或者学习的特征在空间上进行对齐，从而减少物体由于空间中的旋转、平移、尺度、扭曲等几何变换对分类、定位等任务的影响。加入到已有的CNN或者FCN网络，能够提升网络的学习能力。</p>
<h2 id="STN原理"><a href="#STN原理" class="headerlink" title="STN原理"></a>STN原理</h2><p>STN依赖如下三种传统图像处理技术：</p>
<ul>
<li>仿射矩阵</li>
<li>逆坐标映射</li>
<li>双线性插值</li>
</ul>
<h3 id="放射变换矩阵"><a href="#放射变换矩阵" class="headerlink" title="放射变换矩阵"></a>放射变换矩阵</h3><p>对平面图像放射变换矩阵就是一个2x3的齐次形式的矩阵，以此以实现平移、旋转、缩放、剪裁，这个传统空间变换的基本概念，这里就不细写了。</p>
<h3 id="逆向坐标映射"><a href="#逆向坐标映射" class="headerlink" title="逆向坐标映射"></a>逆向坐标映射</h3><p>这仍然是图像处理中常用的手段，当我已知一个空间变换的映射后，要得到目标图像，正向的方法是：对源图像做正映射从而得到目标。正映射的缺点是目标图像受限于原图，如当变换是带有放大操作时，目标图像必然会有某些像素点没有值，因为这些点的正变换在源图像中是没有点与之对应。所以更好的办法时做逆向坐标映射，逆向映射是正映射的反映射，使用逆向映射目标图像的任意点总能找到源图像中的位置或者坐标，当然这个坐标有可能是小数或者超出原图像的范围。</p>
<p>对于仿射矩阵，逆映射是正映射放射矩阵的逆矩阵。</p>
<h3 id="双线性插值"><a href="#双线性插值" class="headerlink" title="双线性插值"></a>双线性插值</h3><p>承接上面逆向坐标变换图像放大操作的例子，在正向映射中为目标图像为空洞的那些像素点，在逆向映射中能够找到原图像中与之相对的位置的坐标，只是这些坐标带有小数，我们需要使用插值的方法对这些像素点进行补值，图像中插值方法最常用的就是双线性插值了。</p>
<p>双线性插值相对来说是一种比较简单但是有能保证一定质量的插值方法，公式这里就不写了。</p>
<h2 id="STN网络结构"><a href="#STN网络结构" class="headerlink" title="STN网络结构"></a>STN网络结构</h2><p>STN主要由三部分组成：</p>
<ul>
<li>localisation network</li>
<li>grid generator</li>
<li>sampler</li>
</ul>
<p>下图为STN基本结构示意图</p>
<p><img src="/markdownImage/stn.jpg" alt="Spatial Transformer Network"></p>
<h3 id="Localisation-Network"><a href="#Localisation-Network" class="headerlink" title="Localisation Network"></a>Localisation Network</h3><p>Localisation Network可以翻译成定位网络，它的输入是feature map，输出就是仿射变换矩阵。在上面的示意图中，我们看到在Localisation Network画了两对象体，前面的作用是做计算，可以是全连接也可以是卷积，后面是回归层作用是将映射做归一化。</p>
<h3 id="grid-generator"><a href="#grid-generator" class="headerlink" title="grid generator"></a>grid generator</h3><p>grid generator的作用就是生成双线性插值的坐标网络，它实现的就是逆向坐标映射的结果。</p>
<h3 id="sampler"><a href="#sampler" class="headerlink" title="sampler"></a>sampler</h3><p>sampler就是使用双线性插值的得到目标图的过程，作者也叫这一步Differentiable Image<br>Sampling，是希望通过写成一种形式上可微的图像采样方法，目的是为了让整个网络保持可以端到端反向传播BP训练。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>以上，具体结构还是的看原始论文，关于STN的初步内容就介绍完成，写的非常简略的原因是，我参考的大部分文章都对STN网络结构了解到非常深入的程度，所以我也怕写错，详细的东西如还是需要仔细看论文。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol>
<li><a href="https://www.cnblogs.com/neopenx/p/4851806.html" target="_blank" rel="noopener">Spatial Transformer Networks(空间变换神经网络)</a></li>
<li><a href="https://blog.csdn.net/shaoxiaohu1/article/details/51809605" target="_blank" rel="noopener">【论文笔记】Spatial Transformer Networks</a></li>
</ol>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://yoursite.com/2018/05/26/SpatialTransformerNetwork了解/" data-id="cjqwcifzf001a5cvdxyi2bxiw" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-使用OpenCV进行相机标定" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2018/05/23/使用OpenCV进行相机标定/">使用OpenCV进行相机标定</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2018/05/23/使用OpenCV进行相机标定/">
            <time datetime="2018-05-23T13:11:05.000Z" itemprop="datePublished">2018-05-23</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/技术/">技术</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/技术/机器视觉/">机器视觉</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/opencv/">opencv</a>, <a class="tag-link" href="/tags/双目视觉/">双目视觉</a>, <a class="tag-link" href="/tags/张氏标定/">张氏标定</a>, <a class="tag-link" href="/tags/机器视觉/">机器视觉</a>, <a class="tag-link" href="/tags/相机标定/">相机标定</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>前面我总结过两篇关于双目相机的原理以及张氏标定法理论的介绍，而在本文中将通过使用openCV编写标定代码来标定ZED双目相机，不过在此之前先简单了解一下ZED相机（以下介绍参考取官方网站的内容:<a href="https://www.stereolabs.com/zed/" target="_blank" rel="noopener">stereolabs.com/zed/</a>）。</p>
<ul>
<li>视频流的帧率和分辨率：</li>
</ul>
<table>
<thead>
<tr>
<th>模式</th>
<th>FPS</th>
<th>分辨率</th>
</tr>
</thead>
<tbody>
<tr>
<td>2.2K</td>
<td>15</td>
<td>4416x1242</td>
</tr>
<tr>
<td>1080p</td>
<td>30</td>
<td>3840x1080</td>
</tr>
<tr>
<td>720p</td>
<td>60</td>
<td>2560x720</td>
</tr>
<tr>
<td>WVGA</td>
<td>100</td>
<td>1344x376</td>
</tr>
</tbody>
</table>
<ul>
<li>Stereo Baseline：120 mm</li>
<li>光圈：ƒ/2.0</li>
<li>视角：90° (H) x 60° (V) x 110° (D) max</li>
<li>深度范围：0.5 - 20 m (2.3 to 65 ft)</li>
<li>深度值位数：32-bits</li>
</ul>
<h2 id="获取ZED的图像"><a href="#获取ZED的图像" class="headerlink" title="获取ZED的图像"></a>获取ZED的图像</h2><p>三种方法可以采集ZED相机拍摄的图像：</p>
<ol>
<li>使用SDK中厂商提供的工具</li>
<li>使用SDK提供的接口函数</li>
<li>直接使用OpenCV获取</li>
</ol>
<p>由于ZED的SDK完全依赖Nvidia的cudn，而我没有Nvidia的显卡，所以没法使用。不过ZED相机遵循UVC接口标准，而且仅仅需要采集其双目的原始图像，所以只用OpenCV即可，代码与其他摄像头一样：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">print(sys.version)</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">cap = cv2.VideoCapture(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> cap.isOpened():</span><br><span class="line">    print(<span class="string">'Open Camera fail!'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ret, frame = cap.read()</span><br></pre></td></tr></table></figure>
<p>检查采集到的图像：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pairImageShow</span><span class="params">(img1, img2, mode11=None, model2=None)</span>:</span></span><br><span class="line">    plt.figure(figsize=(<span class="number">15</span>,<span class="number">15</span>))</span><br><span class="line">    plt.subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> mode11 == <span class="string">'gray'</span>:</span><br><span class="line">        plt.imshow(img1, cmap=<span class="string">'gray'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        plt.imshow(img1)</span><br><span class="line">    plt.subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">if</span> model2 == <span class="string">'gray'</span>:</span><br><span class="line">        plt.imshow(img2, cmap=<span class="string">'gray'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        plt.imshow(img2)</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line">imgs_l = []</span><br><span class="line">imgs_r = []</span><br><span class="line">image_path = <span class="string">'../stereo_calibration/ZED_stereo_calibration/calib_image'</span></span><br><span class="line">image_list = os.listdir(image_path)</span><br><span class="line"><span class="keyword">for</span> image_name <span class="keyword">in</span> image_list:</span><br><span class="line"><span class="comment">#     print(image_name)</span></span><br><span class="line">    full_path = os.path.join(image_path, image_name)</span><br><span class="line">    img = cv2.imread(full_path)</span><br><span class="line">    half_col = img.shape[<span class="number">1</span>]//<span class="number">2</span></span><br><span class="line">    imgs_l.append(img[:,:half_col,:])</span><br><span class="line">    imgs_r.append(img[:,half_col:,:])</span><br><span class="line">    </span><br><span class="line">img_rgb_l = cv2.cvtColor(imgs_l[<span class="number">0</span>], cv2.COLOR_BGR2RGB)</span><br><span class="line">img_rgb_r = cv2.cvtColor(imgs_r[<span class="number">0</span>], cv2.COLOR_BGR2RGB)</span><br><span class="line">pairImageShow(img_rgb_l, img_rgb_r)</span><br></pre></td></tr></table></figure>
<h2 id="角点检测"><a href="#角点检测" class="headerlink" title="角点检测"></a>角点检测</h2><p>在前面的张氏标定的原理中，我已经介绍过当前广泛使用的张氏标定法通常用棋盘格作为标定物，通过寻找棋盘格的角点作为空间参考坐标点求未知量。利用opencv中的findChessboardCorners函数可以找到棋盘图像中的角点。</p>
<p>在下面的代码中，boardSize定义了角点的总个数和排列，如（7，5）表示为水平方向为7、竖直方向为5的角点阵列。只有当所有的角点都找到后，findChessboardCorners的返回值isFind才为真。findChessboardCorners函数找到的角点的坐标是不精确的，需要再使用cornerSubPix函数，进行亚像素的调整。对角点检查的结果，使用drawChessboardCorners函数画出来。</p>
<p>角点检测的坐标是角点当前姿态投影到照片的坐标</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getChessboardCorners</span><span class="params">(colorimg, boardSize)</span>:</span></span><br><span class="line">    grayimg = cv2.cvtColor(colorimg, cv2.COLOR_RGB2GRAY)    </span><br><span class="line">    isFind, corners = cv2.findChessboardCorners(colorimg, boardSize, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">if</span> isFind:</span><br><span class="line">        criteria = (cv2.TERM_CRITERIA_EPS + cv2.TERM_CRITERIA_MAX_ITER, <span class="number">20</span>, <span class="number">0.1</span>)  <span class="comment"># 阈值</span></span><br><span class="line">        cv2.cornerSubPix(grayimg, corners, (<span class="number">5</span>,<span class="number">5</span>), (<span class="number">-1</span>,<span class="number">-1</span>), criteria)       </span><br><span class="line">        <span class="keyword">return</span> corners</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">None</span></span><br><span class="line"></span><br><span class="line">w, h = <span class="number">7</span>, <span class="number">5</span></span><br><span class="line">boardSize = (w, h)</span><br><span class="line">corners_l = []</span><br><span class="line">corners_r = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(image_list)):</span><br><span class="line"><span class="comment">#     print('find corner in image:', i)</span></span><br><span class="line">    corner_l = getChessboardCorners(imgs_l[i], boardSize)</span><br><span class="line">    corner_r = getChessboardCorners(imgs_r[i], boardSize)</span><br><span class="line">    <span class="keyword">if</span> corners <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span> <span class="keyword">and</span> corners <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>: </span><br><span class="line">        corners_l.append(corner_l)</span><br><span class="line">        corners_r.append(corner_r)</span><br><span class="line"></span><br><span class="line">cornerimg = cv2.drawChessboardCorners(imgs_l[<span class="number">0</span>], boardSize, corners_l[<span class="number">0</span>], <span class="keyword">True</span>)</span><br><span class="line">cornerimg_rgb = cv2.cvtColor(cornerimg, cv2.COLOR_BGR2RGB)</span><br><span class="line">plt.figure(figsize=(<span class="number">15</span>,<span class="number">15</span>))</span><br><span class="line">plt.imshow(cornerimg_rgb)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>下图为检查结果的截图：</p>
<p><img src="/markdownImage/corner.jpg" alt="corner detected"></p>
<h2 id="计算角点的空间坐标系"><a href="#计算角点的空间坐标系" class="headerlink" title="计算角点的空间坐标系"></a>计算角点的空间坐标系</h2><p>我们都以左上角的角点的为坐标原点，以棋盘格的横向和竖向方向为空间的两个坐标轴，建立空间坐标系，所以所有角点均有一个坐标值为0，而且不管棋盘怎么移动，角点的空间坐标都不变。使用numpy的mgrid函数生成网格坐标是十分好用的，虽然理解上需要点时间。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">block_w = <span class="number">51</span></span><br><span class="line">block_h = <span class="number">50</span></span><br><span class="line"></span><br><span class="line">corner_real_coord = np.zeros((w*h,<span class="number">3</span>), np.float32)</span><br><span class="line">grid_data = np.mgrid[<span class="number">0</span>:w,<span class="number">0</span>:h]</span><br><span class="line">grid_data[<span class="number">0</span>,:,:] *= block_w</span><br><span class="line">grid_data[<span class="number">1</span>,:,:] *= block_h</span><br><span class="line">corner_real_coord[:,:<span class="number">2</span>] = grid_data.T.reshape(<span class="number">-1</span>,<span class="number">2</span>)</span><br><span class="line">img_pair_num = len(corners_l)</span><br><span class="line">print(img_pair_num)</span><br><span class="line">corner_real_coords = [corner_real_coord <span class="keyword">for</span> i <span class="keyword">in</span> range(img_pair_num)]</span><br></pre></td></tr></table></figure>
<h2 id="计算内参和外参与畸变系数"><a href="#计算内参和外参与畸变系数" class="headerlink" title="计算内参和外参与畸变系数"></a>计算内参和外参与畸变系数</h2><p>前面的张氏标定原理有介绍，一个单应性矩阵有可以表示一个姿态下图像坐标到空间坐标的映射，而一个单应性矩阵有8个未知量，所以在一张棋盘格纸上需要至少超出8个以上的角点才能求得单应性矩阵。而当单应性矩阵求得后，能够提供两个方程来求相机得内参矩阵。在加入了倾斜因子后，内参矩阵中有5个未知量，所以至少需要3个姿态的棋盘照片。</p>
<p>在opencv中提供了calibrateCamera函数对相机进行标定，这个函数将标定结果、相机的内参数矩阵、畸变系数、旋转矩阵和平移向量一步完成并返回。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ret_l, mtx_l, dist_l, rvecs_l, tvecs_l = cv2.calibrateCamera(corner_real_coord, corners_l, (img_rgb_l.shape[<span class="number">1</span>],img_rgb_l.shape[<span class="number">0</span>]), <span class="keyword">None</span>, <span class="keyword">None</span>)</span><br><span class="line">ret_r, mtx_r, dist_r, rvecs_r, tvecs_r = cv2.calibrateCamera(corner_real_coords, corners_r,(img_rgb_l.shape[<span class="number">1</span>],img_rgb_l.shape[<span class="number">0</span>]), <span class="keyword">None</span>, <span class="keyword">None</span>)</span><br><span class="line">print(<span class="string">'error: '</span>,ret_l)</span><br><span class="line">print(<span class="string">'内参：'</span>,mtx_l)</span><br><span class="line">print(<span class="string">'畸变系数：'</span>,dist_l)</span><br><span class="line"><span class="comment"># print('旋转向量：',rvecs_l)</span></span><br><span class="line"><span class="comment"># print('平移向量：',tvecs_l)</span></span><br></pre></td></tr></table></figure>
<h2 id="去畸变"><a href="#去畸变" class="headerlink" title="去畸变"></a>去畸变</h2><p>使用计算得到畸变系数，使用opencv中提供的undistort函数对图像进行去畸变(要注意如果照片少，畸变系数的误差会很大，校正的效果也不好)。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dst_img = cv2.undistort(imgs_r[<span class="number">0</span>], mtx_r, dist_r)</span><br><span class="line">dst_img_rgb = cv2.cvtColor(dst_img, cv2.COLOR_BGR2RGB)</span><br><span class="line">plt.figure(figsize=(<span class="number">15</span>,<span class="number">15</span>))</span><br><span class="line">plt.imshow(dst_img_rgb)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<h2 id="立体标定与矫正"><a href="#立体标定与矫正" class="headerlink" title="立体标定与矫正"></a>立体标定与矫正</h2><p>使用opencv的stereoCalibrate函数能够同时对两个镜头进行标定，标定结果可以得到两个摄像头的内外参数矩阵和两个摄像头的相对位置的R和T，有一点要注意的就是：由于我们上面已经分别对每个摄像头求出了他们各自的内参，所以在这里就不用重复做了，需要将stereoCalibrate函数的flags参数设置为CALIB_FIX_INTRINSIC。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">crit = (cv2.TERM_CRITERIA_COUNT + cv2.TERM_CRITERIA_EPS, <span class="number">100</span>, <span class="number">1e-5</span>)</span><br><span class="line">ret = cv2.stereoCalibrate(corner_real_coords, corners_l, corners_r,</span><br><span class="line">        mtx_l, dist_l,</span><br><span class="line">        mtx_r, dist_r,</span><br><span class="line">        (img_rgb_l.shape[<span class="number">1</span>],img_rgb_l.shape[<span class="number">0</span>]),</span><br><span class="line">        flags = cv2.CALIB_FIX_INTRINSIC,</span><br><span class="line">        criteria = crit)</span><br><span class="line">R, T = ret[<span class="number">-4</span>:<span class="number">-2</span>]</span><br></pre></td></tr></table></figure>
<p>在实际矫正中，我们是根据两个相机的相对关系，最终得到其在同以平面对其的图像，因此我们需要先求得两个摄像头得矫正变换矩阵。通过opencv得stereoRectify函数可以得到，左右相机需要得变换矩阵Rl、Rr和投影矩阵Pl、Pr：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ret = cv2.stereoRectify(mtx_l, dist_l, mtx_r, dist_r, (img_rgb_l.shape[<span class="number">1</span>],img_rgb_l.shape[<span class="number">0</span>]), R, T)</span><br><span class="line">Rl, Rr, Pl, Pr = ret[:<span class="number">4</span>]</span><br><span class="line">Rl, Rr, Pl, Pr</span><br></pre></td></tr></table></figure>
<p>经过立体标定后，双目相机的相对位置就知道了，然后就可以进行立体矫正，在opencv中需要分两个步骤完成，通过initUndistortRectifyMap得到映<br>射关系，再使用remap函数完成矫正。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">map_l1, map_l2 = cv2.initUndistortRectifyMap(mtx_l, dist_l, Rl, Pl, (img_rgb_l.shape[<span class="number">1</span>],img_rgb_l.shape[<span class="number">0</span>]), cv2.CV_32FC1)</span><br><span class="line">map_r1, map_r2 = cv2.initUndistortRectifyMap(mtx_r, dist_r, Rr, Pr, (img_rgb_l.shape[<span class="number">1</span>],img_rgb_l.shape[<span class="number">0</span>]), cv2.CV_32FC1)</span><br><span class="line"></span><br><span class="line">reimg_l = cv2.remap(imgs_l[<span class="number">10</span>], map_l1, map_l2, cv2.INTER_LINEAR)</span><br><span class="line">reimg_r = cv2.remap(imgs_r[<span class="number">10</span>], map_r1, map_r2, cv2.INTER_LINEAR)</span><br><span class="line">dst_img_rgb = cv2.cvtColor(reimg_r, cv2.COLOR_BGR2RGB)</span><br><span class="line">plt.figure(figsize=(<span class="number">15</span>,<span class="number">15</span>))</span><br><span class="line">plt.imshow(dst_img_rgb)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>画水平线检查，立体矫正得效果。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">cav_w, cav_h = imgs_l[<span class="number">0</span>].shape[<span class="number">1</span>]//<span class="number">2</span>, imgs_l[<span class="number">0</span>].shape[<span class="number">0</span>]//<span class="number">2</span></span><br><span class="line">cavimg = np.zeros((cav_h, cav_w*<span class="number">2</span>, <span class="number">3</span>), np.uint8)</span><br><span class="line"></span><br><span class="line">reimg_l = cv2.remap(imgs_l[<span class="number">1</span>], map_l1, map_l2, cv2.INTER_LINEAR)</span><br><span class="line">reimg_r = cv2.remap(imgs_r[<span class="number">1</span>], map_r1, map_r2, cv2.INTER_LINEAR)</span><br><span class="line">     </span><br><span class="line">cavimg[:,:cav_w,:] = cv2.resize(reimg_l, (cav_w, cav_h))</span><br><span class="line">cavimg[:,cav_w:,:] = cv2.resize(reimg_r, (cav_w, cav_h))</span><br><span class="line">step = cav_h//<span class="number">10</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">    rowval = i*step</span><br><span class="line">    cv2.line(cavimg, (<span class="number">0</span>, rowval), (cav_w*<span class="number">2</span>, rowval), (<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>), <span class="number">1</span>, <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">dst_img_rgb = cv2.cvtColor(cavimg, cv2.COLOR_BGR2RGB)</span><br><span class="line">plt.figure(figsize=(<span class="number">15</span>,<span class="number">15</span>))</span><br><span class="line">plt.imshow(dst_img_rgb)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>保存和读取校准参数，opencv中有模块FileStorage来保存和读取数据，常用保存格式为yml或xml，FileStorage让矩阵的的保存和读取非常方便。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">saveCaliResult</span><span class="params">(file_name, names, params)</span>:</span></span><br><span class="line">    WRITE = <span class="number">1</span></span><br><span class="line">    f = cv2.FileStorage(file_name, WRITE)</span><br><span class="line">    <span class="keyword">for</span> name, val <span class="keyword">in</span> zip(names, params):</span><br><span class="line">        f.write(name, val)</span><br><span class="line">    f.release() </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loadCaliResult</span><span class="params">(califile)</span>:</span></span><br><span class="line">    READ = <span class="number">0</span></span><br><span class="line">    fs = cv2.FileStorage(califile, READ)</span><br><span class="line">    mtx_l = fs.getNode(<span class="string">'mtx_l'</span>).mat()</span><br><span class="line">    mtx_r = fs.getNode(<span class="string">'mtx_r'</span>).mat()</span><br><span class="line">    dist_l = fs.getNode(<span class="string">'dist_l'</span>).mat()</span><br><span class="line">    dist_r = fs.getNode(<span class="string">'dist_r'</span>).mat()</span><br><span class="line">    Rl = fs.getNode(<span class="string">'Rl'</span>).mat()</span><br><span class="line">    Rr = fs.getNode(<span class="string">'Rr'</span>).mat()</span><br><span class="line">    Pl = fs.getNode(<span class="string">'Pl'</span>).mat()</span><br><span class="line">    Pr = fs.getNode(<span class="string">'Pr'</span>).mat()</span><br><span class="line">    fs.release()</span><br><span class="line">    <span class="keyword">return</span> mtx_l, mtx_r, dist_l, dist_r, Rl, Rr, Pl, Pr</span><br></pre></td></tr></table></figure>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol>
<li><a href="https://blog.csdn.net/u010128736/article/details/52875137" target="_blank" rel="noopener">使用OpenCV进行标定（Python）</a></li>
<li><a href="https://www.cnblogs.com/german-iris/p/5199203.html" target="_blank" rel="noopener">双摄像头立体成像(三)-畸变矫正与立体校正</a></li>
</ol>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://yoursite.com/2018/05/23/使用OpenCV进行相机标定/" data-id="cjqwcifzv002w5cvdll1hfvu9" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-JupyterNotebook使用技巧" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2018/05/19/JupyterNotebook使用技巧/">Jupyter Notebook使用技巧</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2018/05/19/JupyterNotebook使用技巧/">
            <time datetime="2018-05-19T07:23:05.000Z" itemprop="datePublished">2018-05-19</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/技术/">技术</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/技术/开发工具环境/">开发工具环境</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/jupyter/">jupyter</a>, <a class="tag-link" href="/tags/markdown/">markdown</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本文的目的是总结和记录我自己在使用jupyter notebook过程中，学到的一些非常好用的功能或者容易遗忘小技巧。</p>
<h2 id="模式切换与快捷键"><a href="#模式切换与快捷键" class="headerlink" title="模式切换与快捷键"></a>模式切换与快捷键</h2><p>用了好久的jupyter notebook，才知道原来它还有两种不同的模式：<strong>命令模式</strong>和<strong>编辑模式</strong>，以下列出在模式切换和不同模式下功能的快捷键：</p>
<h4 id="式切换"><a href="#式切换" class="headerlink" title="式切换"></a>式切换</h4><ul>
<li><strong>ESC</strong>：进入命令模式</li>
<li><strong>Enter</strong>：进入编辑模式</li>
</ul>
<h4 id="模式下的常用的快捷键"><a href="#模式下的常用的快捷键" class="headerlink" title="模式下的常用的快捷键"></a>模式下的常用的快捷键</h4><ul>
<li><strong>Ctrl+Enter</strong>：运行本单元</li>
<li><strong>Shift+Enter</strong>：运行本单元，选中下个单元</li>
<li><strong>Y</strong>：转入代码状态</li>
<li><strong>M</strong>：转入makedown状态</li>
<li><strong>R</strong>：转入raw状态</li>
<li><strong>A</strong>：在上方插入新的单元</li>
<li><strong>B</strong>：在下方插入新的单元</li>
<li><strong>DD</strong>：删除单元</li>
<li><strong>Z</strong>：恢复操作</li>
<li><strong>Shift+M</strong>：合并选中的单元</li>
<li><strong>L</strong>：显示或隐藏行号</li>
<li><strong>II</strong>：中断内核</li>
<li><strong>00</strong>：重启内核</li>
</ul>
<h4 id="辑模式下的常用的快捷键"><a href="#辑模式下的常用的快捷键" class="headerlink" title="辑模式下的常用的快捷键"></a>辑模式下的常用的快捷键</h4><p>由于编辑模式下的快捷方式与其他编辑器类似，所以就不特地列出，这里只记录一个拆分单元的功能。</p>
<ul>
<li><strong>Ctrl+Shift+-</strong>：分割单元</li>
</ul>
<h2 id="激活和关闭交互式的matplotlib图标"><a href="#激活和关闭交互式的matplotlib图标" class="headerlink" title="激活和关闭交互式的matplotlib图标"></a>激活和关闭交互式的matplotlib图标</h2><p>在jupyter notebook中使用matplotlib画图，在普通情况下，只能输出图标格式化后静态的的图像，而没有交互的功能。如果我们需要交互功能需要在cell中执行如下命令：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib notebook</span><br></pre></td></tr></table></figure>
<p>如果不再需要交互式的输出，则可以需要关闭它：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br></pre></td></tr></table></figure>
<p>这种以%或者%%开头的命令叫做magic命令，查询magic命令可以使用%lsmagic来将其打印出来。</p>
<p>除了%符号，jupyter提供“！”作为unix command的前导符合，来运行shell命令，当然只针对部分命令，如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">!python --version</span><br><span class="line">!ls</span><br></pre></td></tr></table></figure>
<h2 id="在jupyter-中执行可执行文件"><a href="#在jupyter-中执行可执行文件" class="headerlink" title="在jupyter 中执行可执行文件"></a>在jupyter 中执行可执行文件</h2><p>尽管jupyter提供magic命令，但是毕竟只是少量的，那么执行第可执行文件或者cmd/bash命令可能需要通过其他方法，如下以一条复合bash命令为例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printfile</span><span class="params">(name)</span>:</span></span><br><span class="line">    lines_str = <span class="string">''</span></span><br><span class="line">    <span class="keyword">with</span> open(name, <span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        lines = f.readlines()</span><br><span class="line">        lines_str = <span class="string">''</span>.join(lines)</span><br><span class="line">    print(lines_str)</span><br><span class="line">    </span><br><span class="line">os.system(<span class="string">'ls | grep model* &gt; test.txt'</span>)</span><br><span class="line">printfile(<span class="string">'test.txt'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="为Jupyter-Notebook添加目录功能"><a href="#为Jupyter-Notebook添加目录功能" class="headerlink" title="为Jupyter Notebook添加目录功能"></a>为Jupyter Notebook添加目录功能</h2><h3 id="在jupyter中添加侧边栏目录"><a href="#在jupyter中添加侧边栏目录" class="headerlink" title="在jupyter中添加侧边栏目录"></a>在jupyter中添加侧边栏目录</h3><p>原始的Jupyter是不支持markdown添加目录功能的，不过我们可以可以利用Jupyter notebook<br>extensions去使得这种功能实现，首先安装jupyter_contrib_nbextensions：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda install -c conda-forge jupyter_contrib_nbextensions</span><br></pre></td></tr></table></figure>
<p>当安装好以后就会发现jupyter上方的菜单中多出了一个Nbextensions的菜单如下图：</p>
<p><img src="/markdownImage/Nbextensions.jpg" alt="Nbextensions"></p>
<p>将Tabel of Contents勾选即可，而在Nbextension还有需要有趣的插件可以去探索。</p>
<h3 id="在文本头增目录"><a href="#在文本头增目录" class="headerlink" title="在文本头增目录"></a>在文本头增目录</h3><p>上面是使用插件生成侧边栏目录，如果只需要在文章的头部生成目录则可以用另外的方法。在纯Markdown文本中是能够使用“[TOC]”来自动生成文章头部目录的，但是在jupyter notebook的cell中无法使用，我们只能通过创建文本内部的链接，手动创建目录，如下所示：</p>
<p><img src="/markdownImage/header.jpg" alt="目录链接"></p>
<h2 id="修改jupyter的工作空间"><a href="#修改jupyter的工作空间" class="headerlink" title="修改jupyter的工作空间"></a>修改jupyter的工作空间</h2><p>修改工作空间有两种方法，一是在进入需要修改的目录中，然后在这个目录下打开jupyter，那么打开的jupyter notebook就会将当前目录做工作空间；二是修改配置文件。</p>
<p>第一种放简单灵活，是我们的首选，但是在Window下命令行启用jupyter，有时候修改工作空间是无效的，所以只能修改配置文件了。配置文件为：jupyter_notebook_config.py，如果不存在则需要手动创建，执行如下命令：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jupyter notebook --generate-config</span><br></pre></td></tr></table></figure>
<p>在jupyter_notebook_config.py文件中找到如下内容，并将c.NotebookApp.notebook_dir的值修改为需要指定的目录:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The directory to use for notebooks and kernels.</span></span><br><span class="line">c.NotebookApp.notebook_dir = <span class="string">u'D:\Jupyter'</span></span><br></pre></td></tr></table></figure>
<h2 id="为jupyter添加内核"><a href="#为jupyter添加内核" class="headerlink" title="为jupyter添加内核"></a>为jupyter添加内核</h2><h4 id="添加新python内核"><a href="#添加新python内核" class="headerlink" title="添加新python内核"></a>添加新python内核</h4><p>以python为例，一般可能有两种情况需要增加内核，一是系统中同时安装了不同版本的python，如python2和python3，二是使用conda等工具创建的不同的python运行环境，在这里我假定是第二种情况。</p>
<p>首先需要安装ipykernel，注意是在要添加的环境中，如下我们先创建了一个虚拟环境，然后在其中安装ipykernel：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">conda create -n py36-test python=<span class="number">3.6</span></span><br><span class="line">source activate py36-test</span><br><span class="line">conda install ipykernel</span><br></pre></td></tr></table></figure>
<p>然后执行如下命令，注意同样是需要在要添加的环境下，下面命令中的python指的就是你要添加的内核，–name是你指定jupyter中添加内核的名字：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m ipykernel install --name py36-test</span><br></pre></td></tr></table></figure>
<p>安装好后就可以在jupyter notebook中Kernel菜单的Change Kernel中看到</p>
<h4 id="查看和删除内核"><a href="#查看和删除内核" class="headerlink" title="查看和删除内核"></a>查看和删除内核</h4><p>查看内核：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jupyter kernelspec list</span><br></pre></td></tr></table></figure>
<p>删除内核：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jupyter kernelspec remove kernelname</span><br></pre></td></tr></table></figure>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://yoursite.com/2018/05/19/JupyterNotebook使用技巧/" data-id="cjqwcifyk00065cvdkysl6ejn" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <nav id="page-nav">
        <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
    </nav>
</section>
            
                
<aside id="sidebar">
   
        
    <div class="widget-wrap">
        <h3 class="widget-title">recent</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2019/01/14/求连通域算法/" class="thumbnail">
    
    
        <span style="background-image:url(/markdownImage/newton_method.gif)" alt="求连通域算法" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/技术/">技术</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/技术/图像处理算法/">图像处理算法</a></p>
                            <p class="item-title"><a href="/2019/01/14/求连通域算法/" class="title">求连通域算法</a></p>
                            <p class="item-date"><time datetime="2019-01-14T12:56:33.000Z" itemprop="datePublished">2019-01-14</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2019/01/14/牛顿法的推导/" class="thumbnail">
    
    
        <span style="background-image:url(/markdownImage/newton_method.gif)" alt="牛顿法的推导" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/技术/">技术</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/技术/机器学习/">机器学习</a></p>
                            <p class="item-title"><a href="/2019/01/14/牛顿法的推导/" class="title">牛顿法的推导</a></p>
                            <p class="item-date"><time datetime="2019-01-14T12:31:49.000Z" itemprop="datePublished">2019-01-14</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/12/25/RCNN网络的认识/" class="thumbnail">
    
    
        <span style="background-image:url(/markdownImage/rcnn.png)" alt="RCNN网络的认识" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/技术/">技术</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/技术/深度学习/">深度学习</a></p>
                            <p class="item-title"><a href="/2018/12/25/RCNN网络的认识/" class="title">RCNN网络的认识</a></p>
                            <p class="item-date"><time datetime="2018-12-25T12:47:25.000Z" itemprop="datePublished">2018-12-25</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/12/17/深度学习主要优化算法总结/" class="thumbnail">
    
    
        <span style="background-image:url(/markdownImage/EMA.png)" alt="深度学习主要优化算法总结" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/技术/">技术</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/技术/深度学习/">深度学习</a></p>
                            <p class="item-title"><a href="/2018/12/17/深度学习主要优化算法总结/" class="title">深度学习主要优化算法总结</a></p>
                            <p class="item-date"><time datetime="2018-12-17T14:10:52.000Z" itemprop="datePublished">2018-12-17</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/12/17/Tensorflow-Keras简单介绍/" class="thumbnail">
    
    
        <span style="background-image:url(/markdownImage/keras_net.jpg)" alt="Tensorflow-Keras简单介绍" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/技术/">技术</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/技术/深度学习/">深度学习</a></p>
                            <p class="item-title"><a href="/2018/12/17/Tensorflow-Keras简单介绍/" class="title">Tensorflow-Keras简单介绍</a></p>
                            <p class="item-date"><time datetime="2018-12-17T13:17:43.000Z" itemprop="datePublished">2018-12-17</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">categories</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/技术/">技术</a><span class="category-list-count">79</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/技术/3D技术/">3D技术</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/OpenGL/">OpenGL</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/OpenNI/">OpenNI</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/Qt/">Qt</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/SLAM/">SLAM</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/WPF/">WPF</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/hexo/">hexo</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/web-spider/">web spider</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/其他/">其他</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/前端/">前端</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/图像处理/">图像处理</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/图像处理算法/">图像处理算法</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/多线程-多进程/">多线程/多进程</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/嵌入式/">嵌入式</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/开发工具环境/">开发工具环境</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/数据可视化/">数据可视化</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/数据库/">数据库</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/机器学习/">机器学习</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/机器视觉/">机器视觉</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/深度学习/">深度学习</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/算法/">算法</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/虚拟现实/">虚拟现实</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/杂谈/">杂谈</a><span class="category-list-count">4</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/杂谈/Minecraft/">Minecraft</a><span class="category-list-count">1</span></li></ul></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">archives</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a><span class="archive-list-count">7</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">tags</h3>
        <div class="widget">
            <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/3D深度传感器/">3D深度传感器</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AI/">AI</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AR/">AR</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Adam/">Adam</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Assimp/">Assimp</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BP算法/">BP算法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/">C#</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/">C++</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CNN/">CNN</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/">CSS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/EMA/">EMA</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/EM算法/">EM算法</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FCN/">FCN</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GLAD/">GLAD</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GLFW/">GLFW</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GLUT/">GLUT</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GMM/">GMM</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML/">HTML</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/InnoDB/">InnoDB</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MIZ702N/">MIZ702N</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MOOC/">MOOC</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Minecraft/">Minecraft</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Momentum/">Momentum</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/">MySQL</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OpenCV/">OpenCV</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OpenGL/">OpenGL</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OpenNI/">OpenNI</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PIL/">PIL</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PyQt/">PyQt</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Qt/">Qt</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Qt-Designer/">Qt Designer</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RCNN/">RCNN</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RMSprop/">RMSprop</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SGD/">SGD</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SLAM/">SLAM</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/STN/">STN</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Shader/">Shader</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spatial-Transformer-Network/">Spatial Transformer Network</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unity3D/">Unity3D</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VR/">VR</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VS/">VS</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WPF/">WPF</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/XAMPP/">XAMPP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ZYNQ7000/">ZYNQ7000</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/anaconda/">anaconda</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/arm-liunx-gcc/">arm-liunx-gcc</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c/">c</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cmake/">cmake</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/conda/">conda</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cython/">cython</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deep-learning/">deep learning</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gluon/">gluon</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/human-visual-system/">human visual system</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jupyter/">jupyter</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/keras/">keras</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/k邻近算法/">k邻近算法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/markdown/">markdown</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/matplotlib/">matplotlib</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mxnet/">mxnet</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/numpy/">numpy</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openCV/">openCV</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/opencv/">opencv</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/phpMyAdmin/">phpMyAdmin</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pip/">pip</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pyassimp/">pyassimp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pyinstaller/">pyinstaller</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pyqt/">pyqt</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a><span class="tag-list-count">22</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scrapy/">scrapy</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sublime/">sublime</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/swig/">swig</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tensorflow/">tensorflow</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web-spider/">web spider</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xpath/">xpath</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/优化算法/">优化算法</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/决策树/">决策树</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端/">前端</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/博客/">博客</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/双目视觉/">双目视觉</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/图像处理/">图像处理</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/图像特征点/">图像特征点</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/基础矩阵/">基础矩阵</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/多线程/">多线程</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/学习总结/">学习总结</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/对极几何/">对极几何</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/嵌入式/">嵌入式</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/张氏标定/">张氏标定</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/搜索算法/">搜索算法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/摄像头/">摄像头</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/最大公约数/">最大公约数</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/最短路径/">最短路径</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/本质矩阵/">本质矩阵</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/机器学习/">机器学习</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/机器视觉/">机器视觉</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/树莓派/">树莓派</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/梯度下降/">梯度下降</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/梯度下降算法/">梯度下降算法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/概率论/">概率论</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/欧几里德算法/">欧几里德算法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/深度学习/">深度学习</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/渲染pipeline/">渲染pipeline</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/游戏/">游戏</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/牛顿法/">牛顿法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/物体检测/">物体检测</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/直方图/">直方图</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/相机标定/">相机标定</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/相机模型/">相机模型</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/神经网络/">神经网络</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/空间变换/">空间变换</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/纹理/">纹理</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/蒙特卡洛算法/">蒙特卡洛算法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/虚拟机/">虚拟机</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/语义分割/">语义分割</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/调试/">调试</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/软件设计/">软件设计</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/连通域/">连通域</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/链式求导/">链式求导</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/驱动开发/">驱动开发</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/高斯混合模型/">高斯混合模型</a><span class="tag-list-count">2</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">tag cloud</h3>
        <div class="widget tagcloud">
            <a href="/tags/3D深度传感器/" style="font-size: 10px;">3D深度传感器</a> <a href="/tags/AI/" style="font-size: 10px;">AI</a> <a href="/tags/AR/" style="font-size: 10px;">AR</a> <a href="/tags/Adam/" style="font-size: 10px;">Adam</a> <a href="/tags/Assimp/" style="font-size: 11.25px;">Assimp</a> <a href="/tags/BP算法/" style="font-size: 10px;">BP算法</a> <a href="/tags/C/" style="font-size: 11.25px;">C#</a> <a href="/tags/C/" style="font-size: 15px;">C++</a> <a href="/tags/CNN/" style="font-size: 11.25px;">CNN</a> <a href="/tags/CSS/" style="font-size: 10px;">CSS</a> <a href="/tags/EMA/" style="font-size: 10px;">EMA</a> <a href="/tags/EM算法/" style="font-size: 11.25px;">EM算法</a> <a href="/tags/FCN/" style="font-size: 10px;">FCN</a> <a href="/tags/GLAD/" style="font-size: 10px;">GLAD</a> <a href="/tags/GLFW/" style="font-size: 10px;">GLFW</a> <a href="/tags/GLUT/" style="font-size: 10px;">GLUT</a> <a href="/tags/GMM/" style="font-size: 11.25px;">GMM</a> <a href="/tags/HTML/" style="font-size: 10px;">HTML</a> <a href="/tags/InnoDB/" style="font-size: 10px;">InnoDB</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/MIZ702N/" style="font-size: 12.5px;">MIZ702N</a> <a href="/tags/MOOC/" style="font-size: 17.5px;">MOOC</a> <a href="/tags/Minecraft/" style="font-size: 10px;">Minecraft</a> <a href="/tags/Momentum/" style="font-size: 10px;">Momentum</a> <a href="/tags/MySQL/" style="font-size: 15px;">MySQL</a> <a href="/tags/OpenCV/" style="font-size: 10px;">OpenCV</a> <a href="/tags/OpenGL/" style="font-size: 13.75px;">OpenGL</a> <a href="/tags/OpenNI/" style="font-size: 10px;">OpenNI</a> <a href="/tags/PIL/" style="font-size: 11.25px;">PIL</a> <a href="/tags/PyQt/" style="font-size: 11.25px;">PyQt</a> <a href="/tags/Qt/" style="font-size: 16.25px;">Qt</a> <a href="/tags/Qt-Designer/" style="font-size: 10px;">Qt Designer</a> <a href="/tags/RCNN/" style="font-size: 10px;">RCNN</a> <a href="/tags/RMSprop/" style="font-size: 10px;">RMSprop</a> <a href="/tags/SGD/" style="font-size: 10px;">SGD</a> <a href="/tags/SLAM/" style="font-size: 11.25px;">SLAM</a> <a href="/tags/STN/" style="font-size: 10px;">STN</a> <a href="/tags/Shader/" style="font-size: 12.5px;">Shader</a> <a href="/tags/Spatial-Transformer-Network/" style="font-size: 10px;">Spatial Transformer Network</a> <a href="/tags/Unity3D/" style="font-size: 11.25px;">Unity3D</a> <a href="/tags/VR/" style="font-size: 10px;">VR</a> <a href="/tags/VS/" style="font-size: 11.25px;">VS</a> <a href="/tags/WPF/" style="font-size: 11.25px;">WPF</a> <a href="/tags/XAMPP/" style="font-size: 10px;">XAMPP</a> <a href="/tags/ZYNQ7000/" style="font-size: 12.5px;">ZYNQ7000</a> <a href="/tags/anaconda/" style="font-size: 10px;">anaconda</a> <a href="/tags/arm-liunx-gcc/" style="font-size: 10px;">arm-liunx-gcc</a> <a href="/tags/c/" style="font-size: 10px;">c</a> <a href="/tags/cmake/" style="font-size: 10px;">cmake</a> <a href="/tags/conda/" style="font-size: 10px;">conda</a> <a href="/tags/cython/" style="font-size: 10px;">cython</a> <a href="/tags/deep-learning/" style="font-size: 15px;">deep learning</a> <a href="/tags/gluon/" style="font-size: 10px;">gluon</a> <a href="/tags/hexo/" style="font-size: 12.5px;">hexo</a> <a href="/tags/human-visual-system/" style="font-size: 10px;">human visual system</a> <a href="/tags/jupyter/" style="font-size: 12.5px;">jupyter</a> <a href="/tags/keras/" style="font-size: 10px;">keras</a> <a href="/tags/k邻近算法/" style="font-size: 10px;">k邻近算法</a> <a href="/tags/markdown/" style="font-size: 11.25px;">markdown</a> <a href="/tags/matplotlib/" style="font-size: 11.25px;">matplotlib</a> <a href="/tags/mxnet/" style="font-size: 11.25px;">mxnet</a> <a href="/tags/numpy/" style="font-size: 13.75px;">numpy</a> <a href="/tags/openCV/" style="font-size: 13.75px;">openCV</a> <a href="/tags/opencv/" style="font-size: 10px;">opencv</a> <a href="/tags/phpMyAdmin/" style="font-size: 10px;">phpMyAdmin</a> <a href="/tags/pip/" style="font-size: 10px;">pip</a> <a href="/tags/pyassimp/" style="font-size: 10px;">pyassimp</a> <a href="/tags/pyinstaller/" style="font-size: 10px;">pyinstaller</a> <a href="/tags/pyqt/" style="font-size: 10px;">pyqt</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/scrapy/" style="font-size: 10px;">scrapy</a> <a href="/tags/sublime/" style="font-size: 10px;">sublime</a> <a href="/tags/swig/" style="font-size: 10px;">swig</a> <a href="/tags/tensorflow/" style="font-size: 10px;">tensorflow</a> <a href="/tags/web-spider/" style="font-size: 11.25px;">web spider</a> <a href="/tags/xpath/" style="font-size: 10px;">xpath</a> <a href="/tags/优化算法/" style="font-size: 11.25px;">优化算法</a> <a href="/tags/决策树/" style="font-size: 10px;">决策树</a> <a href="/tags/前端/" style="font-size: 10px;">前端</a> <a href="/tags/博客/" style="font-size: 13.75px;">博客</a> <a href="/tags/双目视觉/" style="font-size: 13.75px;">双目视觉</a> <a href="/tags/图像处理/" style="font-size: 18.75px;">图像处理</a> <a href="/tags/图像特征点/" style="font-size: 10px;">图像特征点</a> <a href="/tags/基础矩阵/" style="font-size: 10px;">基础矩阵</a> <a href="/tags/多线程/" style="font-size: 11.25px;">多线程</a> <a href="/tags/学习总结/" style="font-size: 11.25px;">学习总结</a> <a href="/tags/对极几何/" style="font-size: 10px;">对极几何</a> <a href="/tags/嵌入式/" style="font-size: 15px;">嵌入式</a> <a href="/tags/张氏标定/" style="font-size: 11.25px;">张氏标定</a> <a href="/tags/搜索算法/" style="font-size: 10px;">搜索算法</a> <a href="/tags/摄像头/" style="font-size: 10px;">摄像头</a> <a href="/tags/最大公约数/" style="font-size: 10px;">最大公约数</a> <a href="/tags/最短路径/" style="font-size: 10px;">最短路径</a> <a href="/tags/本质矩阵/" style="font-size: 10px;">本质矩阵</a> <a href="/tags/机器学习/" style="font-size: 15px;">机器学习</a> <a href="/tags/机器视觉/" style="font-size: 15px;">机器视觉</a> <a href="/tags/树莓派/" style="font-size: 10px;">树莓派</a> <a href="/tags/梯度下降/" style="font-size: 10px;">梯度下降</a> <a href="/tags/梯度下降算法/" style="font-size: 10px;">梯度下降算法</a> <a href="/tags/概率论/" style="font-size: 10px;">概率论</a> <a href="/tags/欧几里德算法/" style="font-size: 10px;">欧几里德算法</a> <a href="/tags/深度学习/" style="font-size: 13.75px;">深度学习</a> <a href="/tags/渲染pipeline/" style="font-size: 10px;">渲染pipeline</a> <a href="/tags/游戏/" style="font-size: 12.5px;">游戏</a> <a href="/tags/牛顿法/" style="font-size: 10px;">牛顿法</a> <a href="/tags/物体检测/" style="font-size: 10px;">物体检测</a> <a href="/tags/直方图/" style="font-size: 11.25px;">直方图</a> <a href="/tags/相机标定/" style="font-size: 12.5px;">相机标定</a> <a href="/tags/相机模型/" style="font-size: 10px;">相机模型</a> <a href="/tags/神经网络/" style="font-size: 11.25px;">神经网络</a> <a href="/tags/空间变换/" style="font-size: 10px;">空间变换</a> <a href="/tags/纹理/" style="font-size: 11.25px;">纹理</a> <a href="/tags/蒙特卡洛算法/" style="font-size: 10px;">蒙特卡洛算法</a> <a href="/tags/虚拟机/" style="font-size: 10px;">虚拟机</a> <a href="/tags/语义分割/" style="font-size: 10px;">语义分割</a> <a href="/tags/调试/" style="font-size: 10px;">调试</a> <a href="/tags/软件设计/" style="font-size: 10px;">软件设计</a> <a href="/tags/连通域/" style="font-size: 10px;">连通域</a> <a href="/tags/链式求导/" style="font-size: 10px;">链式求导</a> <a href="/tags/驱动开发/" style="font-size: 10px;">驱动开发</a> <a href="/tags/高斯混合模型/" style="font-size: 11.25px;">高斯混合模型</a>
        </div>
    </div>

    
        
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">links</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="http://hexo.io">Hexo</a>
                    </li>
                
            </ul>
        </div>
    </div>


    
    <div id="toTop" class="fa fa-angle-up"></div>
</aside>

            
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2019 Harry Mei<br>
            Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
        </div>
    </div>
</footer>
        


    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>